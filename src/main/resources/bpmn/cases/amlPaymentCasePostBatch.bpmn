<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL"
                  xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"
                  xmlns:dc="http://www.omg.org/spec/DD/20100524/DC"
                  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                  xmlns:camunda="http://camunda.org/schema/1.0/bpmn" xmlns:di="http://www.omg.org/spec/DD/20100524/DI"
                  xmlns:modeler="http://camunda.org/schema/modeler/1.0" id="Definitions_09y5nmf"
                  targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="5.5.0"
                  modeler:executionPlatform="Camunda Platform" modeler:executionPlatformVersion="7.15.0">
  <bpmn:message id="Message_0sxqgfv" name="message-drools"/>
  <bpmn:process id="amlPaymentCasePostBatch" name="0. Формирование кейса Постконтроль СО" isExecutable="true">
    <bpmn:laneSet id="LaneSet_05n79jm"/>
    <bpmn:endEvent id="Event_Online_operation">
      <bpmn:incoming>Flow_1fqvnpw</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:exclusiveGateway id="Gateway_08m8030" default="Flow_1fqvnpw">
      <bpmn:incoming>Flow_0gavm8x</bpmn:incoming>
      <bpmn:outgoing>Flow_1fqvnpw</bpmn:outgoing>
      <bpmn:outgoing>Flow_0bfn831</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:serviceTask id="Activity_1qwn6qf" name="Открыть сессию"
                      camunda:delegateExpression="${openSessionRnkbDelegate}">
      <bpmn:incoming>Flow_0bfn831</bpmn:incoming>
      <bpmn:outgoing>Flow_10kplv5</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:scriptTask id="amlPaymentCasePostBatch_checkOffline" name="Достаём переменные" scriptFormat="groovy">
      <bpmn:incoming>Flow_0ijxlkz</bpmn:incoming>
      <bpmn:outgoing>Flow_0o3k3mr</bpmn:outgoing>
      <bpmn:script>import static org.camunda.spin.Spin.JSON

        def jsonStr = execution.getVariable("payload");
        def jsonData = JSON(jsonStr)
        def elements = jsonData.mapTo(Map.class)
        execution.setVariable("isOffline", "Offline".equalsIgnoreCase(elements.get("PaymentCheckType") as
        String))
        execution.setVariable("paymentExId", elements.get("PaymentSourceId") as String)
        execution.setVariable("payload", jsonData)
      </bpmn:script>
    </bpmn:scriptTask>
    <bpmn:startEvent id="Event_0zdf9e0" name="Ответ от Pipeline в Kafka">
      <bpmn:outgoing>Flow_0hlfsn7</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:serviceTask id="Activity_1jae6rb" name="Логирование процесса" camunda:delegateExpression="${loggerDelegate}">
      <bpmn:incoming>Flow_0hlfsn7</bpmn:incoming>
      <bpmn:outgoing>Flow_0ijxlkz</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:sequenceFlow id="Flow_1fqvnpw" sourceRef="Gateway_08m8030" targetRef="Event_Online_operation" />
    <bpmn:sequenceFlow id="Flow_0bfn831" sourceRef="Gateway_08m8030" targetRef="Activity_1qwn6qf">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${isOffline}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_0ijxlkz" sourceRef="Activity_1jae6rb" targetRef="amlPaymentCasePostBatch_checkOffline" />
    <bpmn:sequenceFlow id="Flow_0hlfsn7" sourceRef="Event_0zdf9e0" targetRef="Activity_1jae6rb" />
    <bpmn:serviceTask id="Activity_06ifbzj" name="Логирование процесса" camunda:delegateExpression="${loggerDelegate}">
      <bpmn:incoming>Flow_0o3k3mr</bpmn:incoming>
      <bpmn:outgoing>Flow_0gavm8x</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:sequenceFlow id="Flow_0gavm8x" sourceRef="Activity_06ifbzj" targetRef="Gateway_08m8030" />
    <bpmn:sequenceFlow id="Flow_0o3k3mr" sourceRef="amlPaymentCasePostBatch_checkOffline" targetRef="Activity_06ifbzj" />
    <bpmn:subProcess id="Activity_1ax5jfs">
      <bpmn:incoming>Flow_10kplv5</bpmn:incoming>
      <bpmn:outgoing>Flow_157u96e</bpmn:outgoing>
      <bpmn:startEvent id="Event_09gh81j">
        <bpmn:outgoing>Flow_1sbvndj</bpmn:outgoing>
      </bpmn:startEvent>
      <bpmn:serviceTask id="Activity_0pogohz" name="Получаем Payments" camunda:delegateExpression="${selectDelegate}">
        <bpmn:extensionElements>
          <camunda:inputOutput>
            <camunda:inputParameter name="selectQuery">SELECT p FROM Payment p WHERE p.exId = '${paymentExId}'
            </camunda:inputParameter>
            <camunda:inputParameter name="outputVarName">payments</camunda:inputParameter>
          </camunda:inputOutput>
        </bpmn:extensionElements>
        <bpmn:incoming>Flow_1sbvndj</bpmn:incoming>
        <bpmn:outgoing>Flow_0vh55hu</bpmn:outgoing>
      </bpmn:serviceTask>
      <bpmn:sequenceFlow id="Flow_1sbvndj" sourceRef="Event_09gh81j" targetRef="Activity_0pogohz" />
      <bpmn:exclusiveGateway id="Gateway_0lrgkkq" default="Flow_0lrcrgx">
        <bpmn:incoming>Flow_0vh55hu</bpmn:incoming>
        <bpmn:outgoing>Flow_0aknsys</bpmn:outgoing>
        <bpmn:outgoing>Flow_0lrcrgx</bpmn:outgoing>
      </bpmn:exclusiveGateway>
      <bpmn:scriptTask id="Activity_0ba416y" name="Вынимаем Payment" scriptFormat="groovy">
        <bpmn:extensionElements />
        <bpmn:incoming>Flow_0aknsys</bpmn:incoming>
        <bpmn:outgoing>Flow_18adh9k</bpmn:outgoing>
        <bpmn:script>import com.prime.db.rnkb.model.Payment;

          def payments = execution.getVariable("payments")
          execution.setVariable("payment", payments[0])
          Payment payment = payments[0]
          payment.checkFlagSO = true

          execution.setVariable("payment", payment)
          execution.setVariable("paymentId", payment.id)
        </bpmn:script>
      </bpmn:scriptTask>
      <bpmn:sequenceFlow id="Flow_0aknsys" sourceRef="Gateway_0lrgkkq" targetRef="Activity_0ba416y">
        <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${payments.size() == 1}</bpmn:conditionExpression>
      </bpmn:sequenceFlow>
      <bpmn:sequenceFlow id="Flow_0vh55hu" sourceRef="Activity_0pogohz" targetRef="Gateway_0lrgkkq" />
      <bpmn:endEvent id="Event_0i1b2fj">
        <bpmn:incoming>Flow_0lrcrgx</bpmn:incoming>
      </bpmn:endEvent>
      <bpmn:sequenceFlow id="Flow_0lrcrgx" sourceRef="Gateway_0lrgkkq" targetRef="Event_0i1b2fj" />
      <bpmn:serviceTask id="Activity_1ik6fij" name="Логирование процесса" camunda:delegateExpression="${loggerDelegate}">
        <bpmn:incoming>Flow_18adh9k</bpmn:incoming>
        <bpmn:outgoing>Flow_1drdweu</bpmn:outgoing>
      </bpmn:serviceTask>
      <bpmn:sequenceFlow id="Flow_18adh9k" sourceRef="Activity_0ba416y" targetRef="Activity_1ik6fij" />
      <bpmn:serviceTask id="Activity_0sbdk1p" name="StartTransactionDelegate" camunda:delegateExpression="${startTransactionDelegate}">
        <bpmn:incoming>Flow_1drdweu</bpmn:incoming>
        <bpmn:outgoing>Flow_0cqpgsw</bpmn:outgoing>
      </bpmn:serviceTask>
      <bpmn:sequenceFlow id="Flow_1drdweu" sourceRef="Activity_1ik6fij" targetRef="Activity_0sbdk1p" />
      <bpmn:subProcess id="Activity_0y6jre5">
        <bpmn:incoming>Flow_0cqpgsw</bpmn:incoming>
        <bpmn:outgoing>Flow_06lsc37</bpmn:outgoing>
        <bpmn:startEvent id="Event_0uv73k4">
          <bpmn:outgoing>Flow_1ctyssr</bpmn:outgoing>
        </bpmn:startEvent>
        <bpmn:serviceTask id="Activity_1pin8eb" name="Сохранить&#10;Payment" camunda:delegateExpression="${saveObjectDelegate}">
          <bpmn:extensionElements>
            <camunda:inputOutput>
              <camunda:inputParameter name="outputVarName">payment</camunda:inputParameter>
              <camunda:inputParameter name="saveObject">${payment}</camunda:inputParameter>
            </camunda:inputOutput>
          </bpmn:extensionElements>
          <bpmn:incoming>Flow_1ctyssr</bpmn:incoming>
          <bpmn:outgoing>Flow_18js6yr</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:sequenceFlow id="Flow_1ctyssr" sourceRef="Event_0uv73k4" targetRef="Activity_1pin8eb" />
        <bpmn:scriptTask id="Activity_0cq427x" name="Высчитываем сработавшие правила" scriptFormat="groovy">
          <bpmn:incoming>Flow_18js6yr</bpmn:incoming>
          <bpmn:outgoing>Flow_06mh348</bpmn:outgoing>
          <bpmn:script>import static org.camunda.spin.Spin.JSON

            def jsonStr = execution.getVariable("payload");
            def jsonData = JSON(jsonStr)
            def elements = jsonData.mapTo(Map.class)
            def rules = [];
            for (entry in elements) {
            if ((entry.key as String).toLowerCase().startsWith("rule")) {
            if (entry.value as Boolean) {
            def values = (entry.key as String).toLowerCase().split("rule")
            def values1 = values[1].split("_");
                rules.add(values1[0] as String)
                }
                }
                }
                String rulesString;
                if (rules.isEmpty()) {
            rulesString = ""
            } else {
            rulesString = rules.inject { first, second -&gt;
            "$first,$second"
            }
            }
            execution.setVariable("rules", rules)
            execution.setVariable("rulesString", rulesString)
          </bpmn:script>
        </bpmn:scriptTask>
        <bpmn:sequenceFlow id="Flow_18js6yr" sourceRef="Activity_1pin8eb" targetRef="Activity_0cq427x" />
        <bpmn:serviceTask id="Activity_06zjzpv" name="Логирование процесса" camunda:delegateExpression="${loggerDelegate}">
          <bpmn:incoming>Flow_06mh348</bpmn:incoming>
          <bpmn:outgoing>Flow_0k2piq9</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:sequenceFlow id="Flow_06mh348" sourceRef="Activity_0cq427x" targetRef="Activity_06zjzpv" />
        <bpmn:exclusiveGateway id="Gateway_1l60qlp" default="Flow_0v4g8e0">
          <bpmn:incoming>Flow_0k2piq9</bpmn:incoming>
          <bpmn:outgoing>Flow_0hbn0y4</bpmn:outgoing>
          <bpmn:outgoing>Flow_0v4g8e0</bpmn:outgoing>
        </bpmn:exclusiveGateway>
        <bpmn:serviceTask id="Activity_07j6bfd" name="Получаем нужные словари" camunda:delegateExpression="${selectDelegate}">
          <bpmn:extensionElements>
            <camunda:inputOutput>
              <camunda:inputParameter name="outputVarName">baseDictionaries</camunda:inputParameter>
              <camunda:inputParameter name="selectQuery">select bd from BaseDictionary bd where bd.type = (select
                bdt.id from BaseDictionaryType bdt where bdt.code = '272') AND bd.charCode in (${rulesString})
              </camunda:inputParameter>
            </camunda:inputOutput>
          </bpmn:extensionElements>
          <bpmn:incoming>Flow_0hbn0y4</bpmn:incoming>
          <bpmn:outgoing>Flow_049mekf</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:sequenceFlow id="Flow_0hbn0y4" sourceRef="Gateway_1l60qlp" targetRef="Activity_07j6bfd">
          <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${!rules.isEmpty()}          </bpmn:conditionExpression>
        </bpmn:sequenceFlow>
        <bpmn:sequenceFlow id="Flow_0k2piq9" sourceRef="Activity_06zjzpv" targetRef="Gateway_1l60qlp" />
        <bpmn:endEvent id="Event_1xo0egh">
          <bpmn:incoming>Flow_0v4g8e0</bpmn:incoming>
        </bpmn:endEvent>
        <bpmn:sequenceFlow id="Flow_0v4g8e0" sourceRef="Gateway_1l60qlp" targetRef="Event_1xo0egh" />
        <bpmn:serviceTask id="Activity_0msip7o" name="Получаем CO" camunda:delegateExpression="${selectDelegate}">
          <bpmn:extensionElements>
            <camunda:inputOutput>
              <camunda:inputParameter name="selectQuery">select co from CaseOperation co inner join Case c on
                co.caseId=c.id inner join BaseDictionary bd on c.caseType = bd.id WHERE c.caseType=${caseTypeBd.id} and
                co.paymentId =${paymentId}
              </camunda:inputParameter>
              <camunda:inputParameter name="outputVarName">caseOperations</camunda:inputParameter>
            </camunda:inputOutput>
          </bpmn:extensionElements>
          <bpmn:incoming>Flow_06i0zlt</bpmn:incoming>
          <bpmn:outgoing>Flow_0o16oaf</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:sequenceFlow id="Flow_049mekf" sourceRef="Activity_07j6bfd" targetRef="Activity_0k69n9y" />
        <bpmn:serviceTask id="Activity_1ut6v4x" name="Логирование процесса" camunda:delegateExpression="${loggerDelegate}">
          <bpmn:incoming>Flow_0o16oaf</bpmn:incoming>
          <bpmn:outgoing>Flow_1fxfnaa</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:sequenceFlow id="Flow_0o16oaf" sourceRef="Activity_0msip7o" targetRef="Activity_1ut6v4x" />
        <bpmn:endEvent id="Event_1wlrkve">
          <bpmn:incoming>Flow_1fxfnaa</bpmn:incoming>
        </bpmn:endEvent>
        <bpmn:sequenceFlow id="Flow_1fxfnaa" sourceRef="Activity_1ut6v4x" targetRef="Event_1wlrkve" />
        <bpmn:sequenceFlow id="Flow_06i0zlt" sourceRef="Activity_0k69n9y" targetRef="Activity_0msip7o" />
        <bpmn:serviceTask id="Activity_0k69n9y" name="Получаем словарь типа кейса" camunda:delegateExpression="${selectOneDelegate}">
          <bpmn:extensionElements>
            <camunda:inputOutput>
              <camunda:inputParameter name="outputVarName">caseTypeBd</camunda:inputParameter>
              <camunda:inputParameter name="selectQuery">select bd from BaseDictionary bd where bd.type = (select
                bdt.id from BaseDictionaryType bdt where bdt.code = '18') AND bd.code='4'
              </camunda:inputParameter>
            </camunda:inputOutput>
          </bpmn:extensionElements>
          <bpmn:incoming>Flow_049mekf</bpmn:incoming>
          <bpmn:outgoing>Flow_06i0zlt</bpmn:outgoing>
        </bpmn:serviceTask>
      </bpmn:subProcess>
      <bpmn:sequenceFlow id="Flow_0cqpgsw" sourceRef="Activity_0sbdk1p" targetRef="Activity_0y6jre5" />
      <bpmn:exclusiveGateway id="Gateway_1w23zc6" default="Flow_0m4ur56">
        <bpmn:incoming>Flow_06lsc37</bpmn:incoming>
        <bpmn:outgoing>Flow_1k9y2g5</bpmn:outgoing>
        <bpmn:outgoing>Flow_0m4ur56</bpmn:outgoing>
      </bpmn:exclusiveGateway>
      <bpmn:sequenceFlow id="Flow_06lsc37" sourceRef="Activity_0y6jre5" targetRef="Gateway_1w23zc6" />
      <bpmn:sequenceFlow id="Flow_1k9y2g5" sourceRef="Gateway_1w23zc6" targetRef="Activity_0y09n4q">
        <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${caseOperations.isEmpty() == false and caseOperations != null and caseOperations.size() &gt; 0}        </bpmn:conditionExpression>
      </bpmn:sequenceFlow>
      <bpmn:subProcess id="Activity_0y09n4q">
        <bpmn:incoming>Flow_1k9y2g5</bpmn:incoming>
        <bpmn:outgoing>Flow_1xc0rm5</bpmn:outgoing>
        <bpmn:startEvent id="Event_1gakj31">
          <bpmn:outgoing>Flow_1ufm3zu</bpmn:outgoing>
        </bpmn:startEvent>
        <bpmn:scriptTask id="Activity_0q1u7ac" name="Проставляем переменные для CASERULES" scriptFormat="groovy">
          <bpmn:incoming>Flow_1ufm3zu</bpmn:incoming>
          <bpmn:outgoing>Flow_0o8qg6a</bpmn:outgoing>
          <bpmn:script>import com.prime.db.rnkb.model.CaseOperation

            List&lt;CaseOperation&gt; caseOperation = execution.getVariable("caseOperations")
            Long caseId = caseOperation.get(0).getCaseId().getId()
            execution.setVariable("caseId", caseId)
          </bpmn:script>
        </bpmn:scriptTask>
        <bpmn:sequenceFlow id="Flow_1ufm3zu" sourceRef="Event_1gakj31" targetRef="Activity_0q1u7ac" />
        <bpmn:serviceTask id="Activity_1c009cx" name="Получаем список отработавших правил" camunda:delegateExpression="${selectDelegate}">
          <bpmn:extensionElements>
            <camunda:inputOutput>
              <camunda:inputParameter name="selectQuery">select cr from CaseRules cr where cr.caseId = ${caseId}
              </camunda:inputParameter>
              <camunda:inputParameter name="outputVarName">caseRules</camunda:inputParameter>
            </camunda:inputOutput>
          </bpmn:extensionElements>
          <bpmn:incoming>Flow_1gnbiyl</bpmn:incoming>
          <bpmn:outgoing>Flow_0qbk3gz</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:scriptTask id="Activity_1y52sob" name="Формируем новые CASERULES" scriptFormat="groovy">
          <bpmn:incoming>Flow_0kfq50q</bpmn:incoming>
          <bpmn:outgoing>Flow_1p9npa3</bpmn:outgoing>
          <bpmn:script>import com.prime.db.rnkb.model.BaseDictionary
            import com.prime.db.rnkb.model.Case
            import com.prime.db.rnkb.model.CaseRules

            BaseDictionary getBd(int type, String code) {
            baseDictRepo.getByBaseDictionaryTypeCodeAndCode(type, code);
            }

            List&lt;CaseRules&gt; caseRules = execution.getVariable("caseRules")
            Long caseId = execution.getVariable("caseId")
            List&lt;BaseDictionary&gt; newRulesBd = execution.getVariable("baseDictionaries")
                List&lt;BaseDictionary&gt; newRulesLocal = []
                def existsRule = []
                def newRules = []

                caseRules.forEach({ c -&gt;
                if(c.ruleId != null)
                existsRule.add(c.ruleId.id)
                })

                newRulesBd.forEach({ bd -&gt;
                if (!existsRule.contains(bd.getId())) {
                newRulesLocal.add(bd)
                }
                })

                newRulesLocal.forEach({bd-&gt;
                CaseRules cr = new CaseRules();
                Case aCase = new Case();
            aCase.setId(caseId);
            cr.setRuleId(bd)
            cr.setCaseId(aCase)
            cr.code = getBd(75, "6001")
            newRules.add(cr)
            })

            execution.setVariable("newRules",newRules)
          </bpmn:script>
        </bpmn:scriptTask>
        <bpmn:serviceTask id="Activity_18uh03o" name="Сохранить&#10;CASERULES" camunda:delegateExpression="${saveObjectListDelegate}">
          <bpmn:extensionElements>
            <camunda:inputOutput>
              <camunda:inputParameter name="outputVarName">newRules</camunda:inputParameter>
              <camunda:inputParameter name="saveObjectList">${newRules}</camunda:inputParameter>
            </camunda:inputOutput>
          </bpmn:extensionElements>
          <bpmn:incoming>Flow_1i4u616</bpmn:incoming>
          <bpmn:outgoing>Flow_14kdyzj</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:endEvent id="Event_1t45a4a">
          <bpmn:incoming>Flow_14kdyzj</bpmn:incoming>
        </bpmn:endEvent>
        <bpmn:serviceTask id="Activity_1d0pkbr" name="Логирование процесса" camunda:delegateExpression="${loggerDelegate}">
          <bpmn:incoming>Flow_0o8qg6a</bpmn:incoming>
          <bpmn:outgoing>Flow_1gnbiyl</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:serviceTask id="Activity_01jw7yf" name="Логирование процесса" camunda:delegateExpression="${loggerDelegate}">
          <bpmn:incoming>Flow_1p9npa3</bpmn:incoming>
          <bpmn:outgoing>Flow_1i4u616</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:serviceTask id="Activity_00iazqm" name="Логирование процесса" camunda:delegateExpression="${loggerDelegate}">
          <bpmn:incoming>Flow_0qbk3gz</bpmn:incoming>
          <bpmn:outgoing>Flow_0kfq50q</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:sequenceFlow id="Flow_1gnbiyl" sourceRef="Activity_1d0pkbr" targetRef="Activity_1c009cx" />
        <bpmn:sequenceFlow id="Flow_0qbk3gz" sourceRef="Activity_1c009cx" targetRef="Activity_00iazqm" />
        <bpmn:sequenceFlow id="Flow_0kfq50q" sourceRef="Activity_00iazqm" targetRef="Activity_1y52sob" />
        <bpmn:sequenceFlow id="Flow_1p9npa3" sourceRef="Activity_1y52sob" targetRef="Activity_01jw7yf" />
        <bpmn:sequenceFlow id="Flow_1i4u616" sourceRef="Activity_01jw7yf" targetRef="Activity_18uh03o" />
        <bpmn:sequenceFlow id="Flow_14kdyzj" sourceRef="Activity_18uh03o" targetRef="Event_1t45a4a" />
        <bpmn:sequenceFlow id="Flow_0o8qg6a" sourceRef="Activity_0q1u7ac" targetRef="Activity_1d0pkbr" />
      </bpmn:subProcess>
      <bpmn:serviceTask id="Activity_1i6h2cw" name="EndTransactionDelegate" camunda:delegateExpression="${endTransactionDelegate}">
        <bpmn:incoming>Flow_1xc0rm5</bpmn:incoming>
        <bpmn:outgoing>Flow_12kd06o</bpmn:outgoing>
      </bpmn:serviceTask>
      <bpmn:sequenceFlow id="Flow_1xc0rm5" sourceRef="Activity_0y09n4q" targetRef="Activity_1i6h2cw" />
      <bpmn:endEvent id="Event_0rslf45">
        <bpmn:incoming>Flow_1x1l9mb</bpmn:incoming>
      </bpmn:endEvent>
      <bpmn:sequenceFlow id="Flow_12kd06o" sourceRef="Activity_1i6h2cw" targetRef="Activity_1cpt2gg" />
      <bpmn:subProcess id="Activity_1qhqh1c">
        <bpmn:incoming>Flow_0m4ur56</bpmn:incoming>
        <bpmn:outgoing>Flow_05y7s0x</bpmn:outgoing>
        <bpmn:startEvent id="Event_08vq00w">
          <bpmn:outgoing>Flow_06fmxl5</bpmn:outgoing>
        </bpmn:startEvent>
        <bpmn:scriptTask id="Activity_1sz0i2r" name="Проставляем переменные кейса" scriptFormat="groovy">
          <bpmn:incoming>Flow_06fmxl5</bpmn:incoming>
          <bpmn:outgoing>Flow_1ar0vf8</bpmn:outgoing>
          <bpmn:script>def acceptedCodes = []
            def baseDictionaries = execution.getVariable("baseDictionaries")

            execution.setVariable("caseType", "4")
            execution.setVariable("acceptedRules", baseDictionaries)
            execution.setVariable("acceptedCodes", acceptedCodes)
          </bpmn:script>
        </bpmn:scriptTask>
        <bpmn:serviceTask id="Activity_15hckls" name="Логирование процесса" camunda:delegateExpression="${loggerDelegate}">
          <bpmn:incoming>Flow_1ar0vf8</bpmn:incoming>
          <bpmn:outgoing>Flow_0ob5szp</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:sequenceFlow id="Flow_06fmxl5" sourceRef="Event_08vq00w" targetRef="Activity_1sz0i2r" />
        <bpmn:sequenceFlow id="Flow_1ar0vf8" sourceRef="Activity_1sz0i2r" targetRef="Activity_15hckls" />
        <bpmn:serviceTask id="Activity_06urcbs" name="EndTransactionDelegate" camunda:delegateExpression="${endTransactionDelegate}">
          <bpmn:incoming>Flow_0ob5szp</bpmn:incoming>
          <bpmn:outgoing>Flow_1tccoe5</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:callActivity id="Activity_createCase" name="Формирование кейса" calledElement="caseCreate">
          <bpmn:extensionElements>
            <camunda:in source="payment" target="payment" />
            <camunda:in source="session" target="session" />
            <camunda:in source="acceptedRules" target="acceptedRules" />
            <camunda:in source="caseType" target="caseType" />
            <camunda:in source="acceptedCodes" target="acceptedCodes" />
            <camunda:in businessKey="#{execution.processBusinessKey}"/>
          </bpmn:extensionElements>
          <bpmn:incoming>Flow_1tccoe5</bpmn:incoming>
          <bpmn:outgoing>Flow_1g2ppru</bpmn:outgoing>
        </bpmn:callActivity>
        <bpmn:sequenceFlow id="Flow_0ob5szp" sourceRef="Activity_15hckls" targetRef="Activity_06urcbs" />
        <bpmn:sequenceFlow id="Flow_1tccoe5" sourceRef="Activity_06urcbs" targetRef="Activity_createCase" />
        <bpmn:endEvent id="Event_1nr78u6">
          <bpmn:incoming>Flow_1g2ppru</bpmn:incoming>
        </bpmn:endEvent>
        <bpmn:sequenceFlow id="Flow_1g2ppru" sourceRef="Activity_createCase" targetRef="Event_1nr78u6" />
      </bpmn:subProcess>
      <bpmn:sequenceFlow id="Flow_0m4ur56" sourceRef="Gateway_1w23zc6" targetRef="Activity_1qhqh1c" />
      <bpmn:endEvent id="Event_0n49gcy">
        <bpmn:incoming>Flow_05y7s0x</bpmn:incoming>
      </bpmn:endEvent>
      <bpmn:sequenceFlow id="Flow_05y7s0x" sourceRef="Activity_1qhqh1c" targetRef="Event_0n49gcy" />
      <bpmn:serviceTask id="Activity_1cpt2gg" name="Закрыть сессию"
                        camunda:delegateExpression="${closeSessionRnkbDelegate}">
        <bpmn:incoming>Flow_12kd06o</bpmn:incoming>
        <bpmn:outgoing>Flow_1x1l9mb</bpmn:outgoing>
      </bpmn:serviceTask>
      <bpmn:sequenceFlow id="Flow_1x1l9mb" sourceRef="Activity_1cpt2gg" targetRef="Event_0rslf45" />
    </bpmn:subProcess>
    <bpmn:sequenceFlow id="Flow_10kplv5" sourceRef="Activity_1qwn6qf" targetRef="Activity_1ax5jfs" />
    <bpmn:endEvent id="Event_1javps5">
      <bpmn:incoming>Flow_157u96e</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="Flow_157u96e" sourceRef="Activity_1ax5jfs" targetRef="Event_1javps5" />
    <bpmn:textAnnotation id="TextAnnotation_049rt3r">
      <bpmn:text>payload (JSON)


        PAYMENT.EXID
        Массив кодов сработавших сценариев из справочника 75 Перечень видов операций, сведения о которых
        представляются в уполномоченный орган (Росфинмониторинг)
      </bpmn:text>
    </bpmn:textAnnotation>
    <bpmn:association id="Association_0fu882p" sourceRef="TextAnnotation_049rt3r" targetRef="Event_0zdf9e0" />
    <bpmn:textAnnotation id="TextAnnotation_0ho7fj0" />
    <bpmn:association id="Association_10u5pyr" sourceRef="Activity_1jae6rb" targetRef="TextAnnotation_0ho7fj0" />
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="amlPaymentCasePostBatch">
      <bpmndi:BPMNShape id="Event_1dd4sl3_di" bpmnElement="Event_Online_operation">
        <dc:Bounds x="862" y="552" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_08m8030_di" bpmnElement="Gateway_08m8030" isMarkerVisible="true">
        <dc:Bounds x="855" y="405" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1qwn6qf_di" bpmnElement="Activity_1qwn6qf">
        <dc:Bounds x="990" y="390" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_payload_di" bpmnElement="amlPaymentCasePostBatch_checkOffline">
        <dc:Bounds x="520" y="390" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_0bv2yc6_di" bpmnElement="Event_0zdf9e0">
        <dc:Bounds x="304" y="412" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="279" y="455" width="87" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1jae6rb_di" bpmnElement="Activity_1jae6rb">
        <dc:Bounds x="370" y="390" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_06ifbzj_di" bpmnElement="Activity_06ifbzj">
        <dc:Bounds x="690" y="390" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1ax5jfs_di" bpmnElement="Activity_1ax5jfs" isExpanded="true">
        <dc:Bounds x="1270" y="80" width="4010" height="930" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_09gh81j_di" bpmnElement="Event_09gh81j">
        <dc:Bounds x="1310" y="236" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0pogohz_di" bpmnElement="Activity_0pogohz">
        <dc:Bounds x="1390" y="214" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_0lrgkkq_di" bpmnElement="Gateway_0lrgkkq" isMarkerVisible="true">
        <dc:Bounds x="1545" y="229" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_129eoh6_di" bpmnElement="Activity_0ba416y">
        <dc:Bounds x="1650" y="214" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_0i1b2fj_di" bpmnElement="Event_0i1b2fj">
        <dc:Bounds x="1552" y="342" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1ik6fij_di" bpmnElement="Activity_1ik6fij">
        <dc:Bounds x="1800" y="214" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0sbdk1p_di" bpmnElement="Activity_0sbdk1p">
        <dc:Bounds x="1950" y="214" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0y6jre5_di" bpmnElement="Activity_0y6jre5" isExpanded="true">
        <dc:Bounds x="2130" y="150" width="1250" height="208" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_0uv73k4_di" bpmnElement="Event_0uv73k4">
        <dc:Bounds x="2170" y="232" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1pin8eb_di" bpmnElement="Activity_1pin8eb">
        <dc:Bounds x="2260" y="210" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1t7r7o9_di" bpmnElement="Activity_0cq427x">
        <dc:Bounds x="2420" y="210" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_06zjzpv_di" bpmnElement="Activity_06zjzpv">
        <dc:Bounds x="2560" y="210" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_1l60qlp_di" bpmnElement="Gateway_1l60qlp" isMarkerVisible="true">
        <dc:Bounds x="2705" y="225" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0swjfxj_di" bpmnElement="Activity_07j6bfd">
        <dc:Bounds x="2780" y="210" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_1xo0egh_di" bpmnElement="Event_1xo0egh">
        <dc:Bounds x="2712" y="302" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1fy6wj9_di" bpmnElement="Activity_0msip7o">
        <dc:Bounds x="3030" y="210" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1ut6v4x_di" bpmnElement="Activity_1ut6v4x">
        <dc:Bounds x="3170" y="210" width="100" height="80"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_1wlrkve_di" bpmnElement="Event_1wlrkve">
        <dc:Bounds x="3312" y="232" width="36" height="36"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0i1xzu6_di" bpmnElement="Activity_0k69n9y">
        <dc:Bounds x="2900" y="210" width="100" height="80"/>
        <bpmndi:BPMNLabel/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_1ctyssr_di" bpmnElement="Flow_1ctyssr">
        <di:waypoint x="2206" y="250"/>
        <di:waypoint x="2260" y="250"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_18js6yr_di" bpmnElement="Flow_18js6yr">
        <di:waypoint x="2360" y="250"/>
        <di:waypoint x="2420" y="250"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_06mh348_di" bpmnElement="Flow_06mh348">
        <di:waypoint x="2520" y="250"/>
        <di:waypoint x="2560" y="250"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0hbn0y4_di" bpmnElement="Flow_0hbn0y4">
        <di:waypoint x="2755" y="250"/>
        <di:waypoint x="2780" y="250"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0k2piq9_di" bpmnElement="Flow_0k2piq9">
        <di:waypoint x="2660" y="250"/>
        <di:waypoint x="2705" y="250"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0v4g8e0_di" bpmnElement="Flow_0v4g8e0">
        <di:waypoint x="2730" y="275"/>
        <di:waypoint x="2730" y="302"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_049mekf_di" bpmnElement="Flow_049mekf">
        <di:waypoint x="2880" y="250"/>
        <di:waypoint x="2900" y="250"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0o16oaf_di" bpmnElement="Flow_0o16oaf">
        <di:waypoint x="3130" y="250"/>
        <di:waypoint x="3170" y="250"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1fxfnaa_di" bpmnElement="Flow_1fxfnaa">
        <di:waypoint x="3270" y="250"/>
        <di:waypoint x="3312" y="250"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_06i0zlt_di" bpmnElement="Flow_06i0zlt">
        <di:waypoint x="3000" y="250"/>
        <di:waypoint x="3030" y="250"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="Gateway_1w23zc6_di" bpmnElement="Gateway_1w23zc6" isMarkerVisible="true">
        <dc:Bounds x="3475" y="245" width="50" height="50"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0y09n4q_di" bpmnElement="Activity_0y09n4q" isExpanded="true">
        <dc:Bounds x="3670" y="150" width="1120" height="200"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_1gakj31_di" bpmnElement="Event_1gakj31">
        <dc:Bounds x="3710" y="232" width="36" height="36"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0a602fs_di" bpmnElement="Activity_0q1u7ac">
        <dc:Bounds x="3770" y="210" width="100" height="80"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_05iap0j_di" bpmnElement="Activity_1c009cx">
        <dc:Bounds x="4020" y="210" width="100" height="80"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0f8j3v5_di" bpmnElement="Activity_1y52sob">
        <dc:Bounds x="4300" y="210" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_18uh03o_di" bpmnElement="Activity_18uh03o">
        <dc:Bounds x="4570" y="210" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_1t45a4a_di" bpmnElement="Event_1t45a4a">
        <dc:Bounds x="4722" y="232" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1d0pkbr_di" bpmnElement="Activity_1d0pkbr">
        <dc:Bounds x="3900" y="210" width="100" height="80"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_01jw7yf_di" bpmnElement="Activity_01jw7yf">
        <dc:Bounds x="4430" y="210" width="100" height="80"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_00iazqm_di" bpmnElement="Activity_00iazqm">
        <dc:Bounds x="4170" y="210" width="100" height="80"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_1ufm3zu_di" bpmnElement="Flow_1ufm3zu">
        <di:waypoint x="3746" y="250"/>
        <di:waypoint x="3770" y="250"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1gnbiyl_di" bpmnElement="Flow_1gnbiyl">
        <di:waypoint x="4000" y="250"/>
        <di:waypoint x="4020" y="250"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0qbk3gz_di" bpmnElement="Flow_0qbk3gz">
        <di:waypoint x="4120" y="250"/>
        <di:waypoint x="4170" y="250"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0kfq50q_di" bpmnElement="Flow_0kfq50q">
        <di:waypoint x="4270" y="250"/>
        <di:waypoint x="4300" y="250"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1p9npa3_di" bpmnElement="Flow_1p9npa3">
        <di:waypoint x="4400" y="250"/>
        <di:waypoint x="4430" y="250"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1i4u616_di" bpmnElement="Flow_1i4u616">
        <di:waypoint x="4530" y="250"/>
        <di:waypoint x="4570" y="250"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_14kdyzj_di" bpmnElement="Flow_14kdyzj">
        <di:waypoint x="4670" y="250"/>
        <di:waypoint x="4722" y="250"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0o8qg6a_di" bpmnElement="Flow_0o8qg6a">
        <di:waypoint x="3870" y="250"/>
        <di:waypoint x="3900" y="250"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="BPMNShape_0uenqt7" bpmnElement="Activity_1i6h2cw">
        <dc:Bounds x="4820" y="214" width="100" height="80"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_0rslf45_di" bpmnElement="Event_0rslf45">
        <dc:Bounds x="5122" y="236" width="36" height="36"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1qhqh1c_di" bpmnElement="Activity_1qhqh1c" isExpanded="true">
        <dc:Bounds x="3110" y="450" width="830" height="200"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_08vq00w_di" bpmnElement="Event_08vq00w">
        <dc:Bounds x="3150" y="532" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1h51yqk_di" bpmnElement="Activity_1sz0i2r">
        <dc:Bounds x="3230" y="510" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_15hckls_di" bpmnElement="Activity_15hckls">
        <dc:Bounds x="3400" y="510" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_06urcbs_di" bpmnElement="Activity_06urcbs">
        <dc:Bounds x="3550" y="510" width="100" height="80"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0i0fdee_di" bpmnElement="Activity_createCase">
        <dc:Bounds x="3710" y="510" width="100" height="80"/>
        <bpmndi:BPMNLabel/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_1nr78u6_di" bpmnElement="Event_1nr78u6">
        <dc:Bounds x="3872" y="532" width="36" height="36"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_06fmxl5_di" bpmnElement="Flow_06fmxl5">
        <di:waypoint x="3186" y="550"/>
        <di:waypoint x="3230" y="550"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1ar0vf8_di" bpmnElement="Flow_1ar0vf8">
        <di:waypoint x="3330" y="550"/>
        <di:waypoint x="3400" y="550"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0ob5szp_di" bpmnElement="Flow_0ob5szp">
        <di:waypoint x="3500" y="550"/>
        <di:waypoint x="3550" y="550"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1tccoe5_di" bpmnElement="Flow_1tccoe5">
        <di:waypoint x="3650" y="550"/>
        <di:waypoint x="3710" y="550"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1g2ppru_di" bpmnElement="Flow_1g2ppru">
        <di:waypoint x="3810" y="550"/>
        <di:waypoint x="3872" y="550"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="Event_0n49gcy_di" bpmnElement="Event_0n49gcy">
        <dc:Bounds x="3992" y="532" width="36" height="36"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1ue267h" bpmnElement="Activity_1cpt2gg">
        <dc:Bounds x="4970" y="214" width="100" height="80"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_1sbvndj_di" bpmnElement="Flow_1sbvndj">
        <di:waypoint x="1346" y="254"/>
        <di:waypoint x="1390" y="254"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0aknsys_di" bpmnElement="Flow_0aknsys">
        <di:waypoint x="1595" y="254"/>
        <di:waypoint x="1650" y="254"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0vh55hu_di" bpmnElement="Flow_0vh55hu">
        <di:waypoint x="1490" y="254"/>
        <di:waypoint x="1545" y="254"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0lrcrgx_di" bpmnElement="Flow_0lrcrgx">
        <di:waypoint x="1570" y="279"/>
        <di:waypoint x="1570" y="342"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_18adh9k_di" bpmnElement="Flow_18adh9k">
        <di:waypoint x="1750" y="254"/>
        <di:waypoint x="1800" y="254"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1drdweu_di" bpmnElement="Flow_1drdweu">
        <di:waypoint x="1900" y="254"/>
        <di:waypoint x="1950" y="254"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0cqpgsw_di" bpmnElement="Flow_0cqpgsw">
        <di:waypoint x="2050" y="254"/>
        <di:waypoint x="2130" y="254"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_06lsc37_di" bpmnElement="Flow_06lsc37">
        <di:waypoint x="3380" y="270"/>
        <di:waypoint x="3475" y="270"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1k9y2g5_di" bpmnElement="Flow_1k9y2g5">
        <di:waypoint x="3525" y="270"/>
        <di:waypoint x="3670" y="270"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1xc0rm5_di" bpmnElement="Flow_1xc0rm5">
        <di:waypoint x="4790" y="254"/>
        <di:waypoint x="4820" y="254"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_12kd06o_di" bpmnElement="Flow_12kd06o">
        <di:waypoint x="4920" y="254"/>
        <di:waypoint x="4970" y="254"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0m4ur56_di" bpmnElement="Flow_0m4ur56">
        <di:waypoint x="3500" y="295"/>
        <di:waypoint x="3500" y="450"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_05y7s0x_di" bpmnElement="Flow_05y7s0x">
        <di:waypoint x="3940" y="550"/>
        <di:waypoint x="3992" y="550"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1x1l9mb_di" bpmnElement="Flow_1x1l9mb">
        <di:waypoint x="5070" y="254"/>
        <di:waypoint x="5122" y="254"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="Event_1javps5_di" bpmnElement="Event_1javps5">
        <dc:Bounds x="5372" y="232" width="36" height="36"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="TextAnnotation_049rt3r_di" bpmnElement="TextAnnotation_049rt3r">
        <dc:Bounds x="160" y="260" width="323" height="125"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="TextAnnotation_0ho7fj0_di" bpmnElement="TextAnnotation_0ho7fj0">
        <dc:Bounds x="470" y="310" width="100" height="30"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_1fqvnpw_di" bpmnElement="Flow_1fqvnpw">
        <di:waypoint x="880" y="455"/>
        <di:waypoint x="880" y="552"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0bfn831_di" bpmnElement="Flow_0bfn831">
        <di:waypoint x="905" y="430"/>
        <di:waypoint x="990" y="430"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0ijxlkz_di" bpmnElement="Flow_0ijxlkz">
        <di:waypoint x="470" y="430"/>
        <di:waypoint x="520" y="430"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0hlfsn7_di" bpmnElement="Flow_0hlfsn7">
        <di:waypoint x="340" y="430"/>
        <di:waypoint x="370" y="430"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0gavm8x_di" bpmnElement="Flow_0gavm8x">
        <di:waypoint x="790" y="430"/>
        <di:waypoint x="855" y="430"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0o3k3mr_di" bpmnElement="Flow_0o3k3mr">
        <di:waypoint x="620" y="430"/>
        <di:waypoint x="690" y="430"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_10kplv5_di" bpmnElement="Flow_10kplv5">
        <di:waypoint x="1090" y="430"/>
        <di:waypoint x="1270" y="430"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_157u96e_di" bpmnElement="Flow_157u96e">
        <di:waypoint x="5280" y="250"/>
        <di:waypoint x="5372" y="250"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Association_0fu882p_di" bpmnElement="Association_0fu882p">
        <di:waypoint x="322" y="385"/>
        <di:waypoint x="322" y="412"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Association_10u5pyr_di" bpmnElement="Association_10u5pyr">
        <di:waypoint x="458" y="390"/>
        <di:waypoint x="506" y="340"/>
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
