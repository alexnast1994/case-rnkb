<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:modeler="http://camunda.org/schema/modeler/1.0" id="Definitions_09y5nmf" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="5.9.0" modeler:executionPlatform="Camunda Platform" modeler:executionPlatformVersion="7.15.0">
  <bpmn:message id="Message_0sxqgfv" name="message-drools" />
  <bpmn:process id="amlPaymentCasePostBatch" name="0. Формирование кейса Постконтроль СО" isExecutable="true">
    <bpmn:laneSet id="LaneSet_05n79jm" />
    <bpmn:serviceTask id="Activity_1qwn6qf" name="Открыть сессию" camunda:delegateExpression="${openSessionRnkbDelegate}">
      <bpmn:incoming>Flow_0gavm8x</bpmn:incoming>
      <bpmn:outgoing>Flow_10kplv5</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:scriptTask id="amlPaymentCasePostBatch_checkOffline" name="Достаём переменные" scriptFormat="groovy">
      <bpmn:incoming>Flow_0ijxlkz</bpmn:incoming>
      <bpmn:outgoing>Flow_0o3k3mr</bpmn:outgoing>
      <bpmn:script>import static org.camunda.spin.Spin.JSON

        def jsonStr = execution.getVariable("payload");
        def jsonData = JSON(jsonStr)
        def elements = jsonData.mapTo(Map.class)
        execution.setVariable("paymentExId", elements.get("PaymentReference") as String)
        execution.setVariable("paymentCheckType", elements.get("PaymentCheckType") as
        String)
        execution.setVariable("payload", jsonData)

      </bpmn:script>
    </bpmn:scriptTask>
    <bpmn:startEvent id="Event_0zdf9e0" name="Ответ от Pipeline в Kafka">
      <bpmn:outgoing>Flow_0hlfsn7</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:serviceTask id="Activity_1jae6rb" name="Логирование процесса" camunda:delegateExpression="${loggerDelegate}">
      <bpmn:incoming>Flow_0hlfsn7</bpmn:incoming>
      <bpmn:outgoing>Flow_0ijxlkz</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:sequenceFlow id="Flow_0ijxlkz" sourceRef="Activity_1jae6rb" targetRef="amlPaymentCasePostBatch_checkOffline" />
    <bpmn:sequenceFlow id="Flow_0hlfsn7" sourceRef="Event_0zdf9e0" targetRef="Activity_1jae6rb" />
    <bpmn:serviceTask id="Activity_06ifbzj" name="Логирование процесса" camunda:delegateExpression="${loggerDelegate}">
      <bpmn:incoming>Flow_0o3k3mr</bpmn:incoming>
      <bpmn:outgoing>Flow_0gavm8x</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:sequenceFlow id="Flow_0gavm8x" sourceRef="Activity_06ifbzj" targetRef="Activity_1qwn6qf" />
    <bpmn:sequenceFlow id="Flow_0o3k3mr" sourceRef="amlPaymentCasePostBatch_checkOffline" targetRef="Activity_06ifbzj" />
    <bpmn:subProcess id="Activity_1ax5jfs">
      <bpmn:incoming>Flow_10kplv5</bpmn:incoming>
      <bpmn:outgoing>Flow_0kf9713</bpmn:outgoing>
      <bpmn:startEvent id="Event_09gh81j">
        <bpmn:outgoing>Flow_1sbvndj</bpmn:outgoing>
      </bpmn:startEvent>
      <bpmn:serviceTask id="Activity_0pogohz" name="Получаем Payments" camunda:delegateExpression="${selectDelegate}">
        <bpmn:extensionElements>
          <camunda:inputOutput>
            <camunda:inputParameter name="selectQuery">SELECT p FROM Payment p WHERE p.paymentReference = '${paymentExId}'
            </camunda:inputParameter>
            <camunda:inputParameter name="outputVarName">payments</camunda:inputParameter>
          </camunda:inputOutput>
        </bpmn:extensionElements>
        <bpmn:incoming>Flow_1sbvndj</bpmn:incoming>
        <bpmn:outgoing>Flow_0vh55hu</bpmn:outgoing>
      </bpmn:serviceTask>
      <bpmn:sequenceFlow id="Flow_1sbvndj" sourceRef="Event_09gh81j" targetRef="Activity_0pogohz" />
      <bpmn:exclusiveGateway id="Gateway_0lrgkkq" default="Flow_0lrcrgx">
        <bpmn:incoming>Flow_0vh55hu</bpmn:incoming>
        <bpmn:outgoing>Flow_0aknsys</bpmn:outgoing>
        <bpmn:outgoing>Flow_0lrcrgx</bpmn:outgoing>
      </bpmn:exclusiveGateway>
      <bpmn:scriptTask id="Activity_0ba416y" name="Вынимаем Payment" scriptFormat="groovy">
        <bpmn:extensionElements />
        <bpmn:incoming>Flow_0aknsys</bpmn:incoming>
        <bpmn:outgoing>Flow_18adh9k</bpmn:outgoing>
        <bpmn:script>import com.prime.db.rnkb.model.Payment;

          def payments = execution.getVariable("payments")
          execution.setVariable("payment", payments[0])
          Payment payment = payments[0]
          payment.checkFlagSO = true

          execution.setVariable("payment", payment)
          execution.setVariable("paymentId", payment.id)
        </bpmn:script>
      </bpmn:scriptTask>
      <bpmn:sequenceFlow id="Flow_0aknsys" sourceRef="Gateway_0lrgkkq" targetRef="Activity_0ba416y">
        <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${payments.size() == 1}</bpmn:conditionExpression>
      </bpmn:sequenceFlow>
      <bpmn:sequenceFlow id="Flow_0vh55hu" sourceRef="Activity_0pogohz" targetRef="Gateway_0lrgkkq" />
      <bpmn:endEvent id="Event_0i1b2fj">
        <bpmn:incoming>Flow_0udljpz</bpmn:incoming>
      </bpmn:endEvent>
      <bpmn:sequenceFlow id="Flow_0lrcrgx" sourceRef="Gateway_0lrgkkq" targetRef="Activity_1cxizrl" />
      <bpmn:serviceTask id="Activity_1ik6fij" name="Логирование процесса" camunda:delegateExpression="${loggerDelegate}">
        <bpmn:incoming>Flow_18adh9k</bpmn:incoming>
        <bpmn:outgoing>Flow_1drdweu</bpmn:outgoing>
      </bpmn:serviceTask>
      <bpmn:sequenceFlow id="Flow_18adh9k" sourceRef="Activity_0ba416y" targetRef="Activity_1ik6fij" />
      <bpmn:serviceTask id="Activity_0sbdk1p" name="StartTransactionDelegate" camunda:delegateExpression="${startTransactionDelegate}">
        <bpmn:incoming>Flow_1drdweu</bpmn:incoming>
        <bpmn:outgoing>Flow_0cqpgsw</bpmn:outgoing>
      </bpmn:serviceTask>
      <bpmn:sequenceFlow id="Flow_1drdweu" sourceRef="Activity_1ik6fij" targetRef="Activity_0sbdk1p" />
      <bpmn:subProcess id="Activity_0y6jre5">
        <bpmn:incoming>Flow_0cqpgsw</bpmn:incoming>
        <bpmn:outgoing>Flow_18wv7q1</bpmn:outgoing>
        <bpmn:startEvent id="Event_0uv73k4">
          <bpmn:outgoing>Flow_1ctyssr</bpmn:outgoing>
        </bpmn:startEvent>
        <bpmn:serviceTask id="Activity_1pin8eb" name="Сохранить&#10;Payment" camunda:delegateExpression="${saveObjectDelegate}">
          <bpmn:extensionElements>
            <camunda:inputOutput>
              <camunda:inputParameter name="outputVarName">payment</camunda:inputParameter>
              <camunda:inputParameter name="saveObject">${payment}</camunda:inputParameter>
            </camunda:inputOutput>
          </bpmn:extensionElements>
          <bpmn:incoming>Flow_1ctyssr</bpmn:incoming>
          <bpmn:outgoing>Flow_18js6yr</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:sequenceFlow id="Flow_1ctyssr" sourceRef="Event_0uv73k4" targetRef="Activity_1pin8eb" />
        <bpmn:scriptTask id="Activity_0cq427x" name="Высчитываем сработавшие правила" scriptFormat="groovy">
          <bpmn:incoming>Flow_18js6yr</bpmn:incoming>
          <bpmn:outgoing>Flow_06mh348</bpmn:outgoing>
          <bpmn:script>import static org.camunda.spin.Spin.JSON

def jsonStr = execution.getVariable("payload");
def jsonData = JSON(jsonStr)
def elements = jsonData.mapTo(Map.class)
def rules = []
def isOpok = false
for (entry in elements) {
    if ((entry.key as String).toLowerCase().startsWith("rule") || (entry.key as String).toLowerCase().startsWith("opok")) {
        if (entry.value as Boolean) {
            def value = (entry.key as String).toLowerCase()
            if (value.size() &gt;=4 ) {
                def prefix = value[0..3]
                if (prefix == "opok") {
                    isOpok = true
                }
                def code = value[4..-1]
                rules.add(code)
            }
        }
    }
}
String rulesString
if (rules.isEmpty()) {
    rulesString = ""
} else {
    rulesString = '\'' + rules.join( '\',\'' ) + '\''
}
execution.setVariable("rules", rules)
execution.setVariable("rulesString", rulesString)
execution.setVariable("isOpok", isOpok)</bpmn:script>
        </bpmn:scriptTask>
        <bpmn:sequenceFlow id="Flow_18js6yr" sourceRef="Activity_1pin8eb" targetRef="Activity_0cq427x" />
        <bpmn:serviceTask id="Activity_06zjzpv" name="Логирование процесса" camunda:delegateExpression="${loggerDelegate}">
          <bpmn:incoming>Flow_06mh348</bpmn:incoming>
          <bpmn:outgoing>Flow_0k2piq9</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:sequenceFlow id="Flow_06mh348" sourceRef="Activity_0cq427x" targetRef="Activity_06zjzpv" />
        <bpmn:exclusiveGateway id="Gateway_1l60qlp" default="Flow_11sng6b">
          <bpmn:incoming>Flow_0k2piq9</bpmn:incoming>
          <bpmn:outgoing>Flow_0hbn0y4</bpmn:outgoing>
          <bpmn:outgoing>Flow_11sng6b</bpmn:outgoing>
        </bpmn:exclusiveGateway>
        <bpmn:serviceTask id="Activity_07j6bfd" name="Получаем нужные словари OPOK" camunda:delegateExpression="${selectDelegate}">
          <bpmn:extensionElements>
            <camunda:inputOutput>
              <camunda:inputParameter name="outputVarName">baseDictionaries</camunda:inputParameter>
              <camunda:inputParameter name="selectQuery">select bd from BaseDictionary bd where bd.type = (select
                bdt.id from BaseDictionaryType bdt where bdt.code = '310') AND bd.code in (${rulesString}) AND bd.isActive = true
              </camunda:inputParameter>
            </camunda:inputOutput>
          </bpmn:extensionElements>
          <bpmn:incoming>Flow_1tl0ep9</bpmn:incoming>
          <bpmn:incoming>Flow_11vob8m</bpmn:incoming>
          <bpmn:outgoing>Flow_070y5j7</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:sequenceFlow id="Flow_0hbn0y4" sourceRef="Gateway_1l60qlp" targetRef="Gateway_1nm5pa4">
          <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${!rules.isEmpty()}          </bpmn:conditionExpression>
        </bpmn:sequenceFlow>
        <bpmn:sequenceFlow id="Flow_0k2piq9" sourceRef="Activity_06zjzpv" targetRef="Gateway_1l60qlp" />
        <bpmn:endEvent id="Event_1xo0egh">
          <bpmn:incoming>Flow_1yyl630</bpmn:incoming>
        </bpmn:endEvent>
        <bpmn:serviceTask id="Activity_0msip7o" name="Получаем CO" camunda:delegateExpression="${selectDelegate}">
          <bpmn:extensionElements>
            <camunda:inputOutput>
              <camunda:inputParameter name="selectQuery">select co from CaseOperation co inner join Case c on
                co.caseId=c.id inner join BaseDictionary bd on c.caseType = bd.id WHERE c.caseType=${caseTypeBd.id} and
                co.paymentId =${paymentId}
              </camunda:inputParameter>
              <camunda:inputParameter name="outputVarName">caseOperations</camunda:inputParameter>
            </camunda:inputOutput>
          </bpmn:extensionElements>
          <bpmn:incoming>Flow_024pt2d</bpmn:incoming>
          <bpmn:incoming>Flow_070y5j7</bpmn:incoming>
          <bpmn:outgoing>Flow_0o16oaf</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:serviceTask id="Activity_1ut6v4x" name="Логирование процесса" camunda:delegateExpression="${loggerDelegate}">
          <bpmn:incoming>Flow_0o16oaf</bpmn:incoming>
          <bpmn:outgoing>Flow_1fxfnaa</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:sequenceFlow id="Flow_0o16oaf" sourceRef="Activity_0msip7o" targetRef="Activity_1ut6v4x" />
        <bpmn:endEvent id="Event_1wlrkve">
          <bpmn:incoming>Flow_1fxfnaa</bpmn:incoming>
        </bpmn:endEvent>
        <bpmn:sequenceFlow id="Flow_1fxfnaa" sourceRef="Activity_1ut6v4x" targetRef="Event_1wlrkve" />
        <bpmn:serviceTask id="Activity_0k69n9y" name="Получаем словарь типа кейса Post" camunda:delegateExpression="${selectOneDelegate}">
          <bpmn:extensionElements>
            <camunda:inputOutput>
              <camunda:inputParameter name="outputVarName">caseTypeBd</camunda:inputParameter>
              <camunda:inputParameter name="selectQuery">select bd from BaseDictionary bd where bd.type = (select
                bdt.id from BaseDictionaryType bdt where bdt.code = '18') AND bd.code='4'
              </camunda:inputParameter>
            </camunda:inputOutput>
          </bpmn:extensionElements>
          <bpmn:incoming>Flow_1jhn9vk</bpmn:incoming>
          <bpmn:outgoing>Flow_0sb7gg4</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:exclusiveGateway id="Gateway_0xdp0cp">
          <bpmn:incoming>Flow_08rzw6c</bpmn:incoming>
          <bpmn:outgoing>Flow_1ee305x</bpmn:outgoing>
          <bpmn:outgoing>Flow_1jhn9vk</bpmn:outgoing>
        </bpmn:exclusiveGateway>
        <bpmn:serviceTask id="Activity_1kupixq" name="Получаем словарь типа кейса Online" camunda:delegateExpression="${selectOneDelegate}">
          <bpmn:extensionElements>
            <camunda:inputOutput>
              <camunda:inputParameter name="outputVarName">caseTypeBd</camunda:inputParameter>
              <camunda:inputParameter name="selectQuery">select bd from BaseDictionary bd where bd.type = (select
                bdt.id from BaseDictionaryType bdt where bdt.code = '18') AND bd.code='3'</camunda:inputParameter>
            </camunda:inputOutput>
          </bpmn:extensionElements>
          <bpmn:incoming>Flow_1ee305x</bpmn:incoming>
          <bpmn:outgoing>Flow_0apv3zj</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:sequenceFlow id="Flow_1ee305x" name="Online?" sourceRef="Gateway_0xdp0cp" targetRef="Activity_1kupixq">
          <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${"Online".equalsIgnoreCase(paymentCheckType)}</bpmn:conditionExpression>
        </bpmn:sequenceFlow>
        <bpmn:sequenceFlow id="Flow_1jhn9vk" name="Offline?" sourceRef="Gateway_0xdp0cp" targetRef="Activity_0k69n9y">
          <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${"Offline".equalsIgnoreCase(paymentCheckType)}</bpmn:conditionExpression>
        </bpmn:sequenceFlow>
        <bpmn:serviceTask id="Activity_1ps26i8" name="Получаем словарь типа кейса Mandatory" camunda:delegateExpression="${selectOneDelegate}">
          <bpmn:extensionElements>
            <camunda:inputOutput>
              <camunda:inputParameter name="outputVarName">caseTypeBd</camunda:inputParameter>
              <camunda:inputParameter name="selectQuery">select bd from BaseDictionary bd where bd.type = (select
                bdt.id from BaseDictionaryType bdt where bdt.code = '18') AND bd.code='2'</camunda:inputParameter>
            </camunda:inputOutput>
          </bpmn:extensionElements>
          <bpmn:incoming>Flow_008r5kq</bpmn:incoming>
          <bpmn:outgoing>Flow_11vob8m</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:serviceTask id="Activity_0wpxlpx" name="Получаем нужные словари RULE" camunda:delegateExpression="${selectDelegate}">
          <bpmn:extensionElements>
            <camunda:inputOutput>
              <camunda:inputParameter name="outputVarName">baseDictionaries</camunda:inputParameter>
              <camunda:inputParameter name="selectQuery">select bd from BaseDictionary bd where bd.type = (select
                bdt.id from BaseDictionaryType bdt where bdt.code = '272') AND bd.code in (${rulesString}) AND bd.isActive = true
              </camunda:inputParameter>
            </camunda:inputOutput>
          </bpmn:extensionElements>
          <bpmn:incoming>Flow_0sb7gg4</bpmn:incoming>
          <bpmn:incoming>Flow_0apv3zj</bpmn:incoming>
          <bpmn:outgoing>Flow_024pt2d</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:exclusiveGateway id="Gateway_1nm5pa4" default="Flow_08rzw6c">
          <bpmn:incoming>Flow_0hbn0y4</bpmn:incoming>
          <bpmn:outgoing>Flow_08rzw6c</bpmn:outgoing>
          <bpmn:outgoing>Flow_1bknnpw</bpmn:outgoing>
        </bpmn:exclusiveGateway>
        <bpmn:sequenceFlow id="Flow_08rzw6c" sourceRef="Gateway_1nm5pa4" targetRef="Gateway_0xdp0cp" />
        <bpmn:serviceTask id="Activity_0ac15qt" name="Закрыть сессию" camunda:delegateExpression="${closeSessionRnkbDelegate}">
          <bpmn:incoming>Flow_11sng6b</bpmn:incoming>
          <bpmn:outgoing>Flow_1yyl630</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:sequenceFlow id="Flow_11sng6b" sourceRef="Gateway_1l60qlp" targetRef="Activity_0ac15qt" />
        <bpmn:sequenceFlow id="Flow_1yyl630" sourceRef="Activity_0ac15qt" targetRef="Event_1xo0egh" />
        <bpmn:exclusiveGateway id="Gateway_0g5akk9">
          <bpmn:incoming>Flow_1bknnpw</bpmn:incoming>
          <bpmn:outgoing>Flow_008r5kq</bpmn:outgoing>
          <bpmn:outgoing>Flow_1g4fcwc</bpmn:outgoing>
        </bpmn:exclusiveGateway>
        <bpmn:sequenceFlow id="Flow_1bknnpw" name="isOPOK?" sourceRef="Gateway_1nm5pa4" targetRef="Gateway_0g5akk9">
          <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${isOpok}</bpmn:conditionExpression>
        </bpmn:sequenceFlow>
        <bpmn:serviceTask id="Activity_09ve2ej" name="Получаем словарь типа кейса Suspending" camunda:delegateExpression="${selectOneDelegate}">
          <bpmn:extensionElements>
            <camunda:inputOutput>
              <camunda:inputParameter name="outputVarName">caseTypeBd</camunda:inputParameter>
              <camunda:inputParameter name="selectQuery">select bd from BaseDictionary bd where bd.type = (select
                bdt.id from BaseDictionaryType bdt where bdt.code = '18') AND bd.code='2'</camunda:inputParameter>
            </camunda:inputOutput>
          </bpmn:extensionElements>
          <bpmn:incoming>Flow_1g4fcwc</bpmn:incoming>
          <bpmn:outgoing>Flow_1tl0ep9</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:sequenceFlow id="Flow_008r5kq" name="Offline?" sourceRef="Gateway_0g5akk9" targetRef="Activity_1ps26i8">
          <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${"Offline".equalsIgnoreCase(paymentCheckType)}</bpmn:conditionExpression>
        </bpmn:sequenceFlow>
        <bpmn:sequenceFlow id="Flow_1g4fcwc" name="Online?" sourceRef="Gateway_0g5akk9" targetRef="Activity_09ve2ej">
          <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${"Online".equalsIgnoreCase(paymentCheckType)}</bpmn:conditionExpression>
        </bpmn:sequenceFlow>
        <bpmn:sequenceFlow id="Flow_1tl0ep9" sourceRef="Activity_09ve2ej" targetRef="Activity_07j6bfd" />
        <bpmn:sequenceFlow id="Flow_11vob8m" sourceRef="Activity_1ps26i8" targetRef="Activity_07j6bfd" />
        <bpmn:sequenceFlow id="Flow_0sb7gg4" sourceRef="Activity_0k69n9y" targetRef="Activity_0wpxlpx" />
        <bpmn:sequenceFlow id="Flow_0apv3zj" sourceRef="Activity_1kupixq" targetRef="Activity_0wpxlpx" />
        <bpmn:sequenceFlow id="Flow_024pt2d" sourceRef="Activity_0wpxlpx" targetRef="Activity_0msip7o" />
        <bpmn:sequenceFlow id="Flow_070y5j7" sourceRef="Activity_07j6bfd" targetRef="Activity_0msip7o" />
      </bpmn:subProcess>
      <bpmn:sequenceFlow id="Flow_0cqpgsw" sourceRef="Activity_0sbdk1p" targetRef="Activity_0y6jre5" />
      <bpmn:exclusiveGateway id="Gateway_1w23zc6" default="Flow_1ygeyrt">
        <bpmn:incoming>Flow_0ij3i33</bpmn:incoming>
        <bpmn:outgoing>Flow_1k9y2g5</bpmn:outgoing>
        <bpmn:outgoing>Flow_1ygeyrt</bpmn:outgoing>
      </bpmn:exclusiveGateway>
      <bpmn:sequenceFlow id="Flow_1k9y2g5" sourceRef="Gateway_1w23zc6" targetRef="Gateway_13y3dcn">
        <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">
          ${execution.hasVariable("caseOperations") == true and caseOperations.isEmpty() == false}
        </bpmn:conditionExpression>
      </bpmn:sequenceFlow>
      <bpmn:subProcess id="Activity_0y09n4q">
        <bpmn:incoming>Flow_0nowm6h</bpmn:incoming>
        <bpmn:outgoing>Flow_1xc0rm5</bpmn:outgoing>
        <bpmn:startEvent id="Event_1gakj31">
          <bpmn:outgoing>Flow_1ufm3zu</bpmn:outgoing>
        </bpmn:startEvent>
        <bpmn:scriptTask id="Activity_0q1u7ac" name="Проставляем переменные для CASERULES" scriptFormat="groovy">
          <bpmn:incoming>Flow_1ufm3zu</bpmn:incoming>
          <bpmn:outgoing>Flow_0o8qg6a</bpmn:outgoing>
          <bpmn:script>import com.prime.db.rnkb.model.CaseOperation

            List&lt;CaseOperation&gt; caseOperation = execution.getVariable("caseOperations")
            Long caseId = caseOperation.get(0).getCaseId().getId()
            execution.setVariable("caseId", caseId)
          </bpmn:script>
        </bpmn:scriptTask>
        <bpmn:sequenceFlow id="Flow_1ufm3zu" sourceRef="Event_1gakj31" targetRef="Activity_0q1u7ac" />
        <bpmn:serviceTask id="Activity_1c009cx" name="Получаем список отработавших правил" camunda:delegateExpression="${selectDelegate}">
          <bpmn:extensionElements>
            <camunda:inputOutput>
              <camunda:inputParameter name="selectQuery">select cr from CaseRules cr where cr.caseId = ${caseId}
              </camunda:inputParameter>
              <camunda:inputParameter name="outputVarName">caseRules</camunda:inputParameter>
            </camunda:inputOutput>
          </bpmn:extensionElements>
          <bpmn:incoming>Flow_1gnbiyl</bpmn:incoming>
          <bpmn:outgoing>Flow_0qbk3gz</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:scriptTask id="Activity_1y52sob" name="Формируем новые CASERULES" scriptFormat="groovy">
          <bpmn:incoming>Flow_0kfq50q</bpmn:incoming>
          <bpmn:outgoing>Flow_1p9npa3</bpmn:outgoing>
          <bpmn:script>import com.prime.db.rnkb.model.BaseDictionary
            import com.prime.db.rnkb.model.Case
            import com.prime.db.rnkb.model.CaseRules

            BaseDictionary getBd(int type, String code) {
            baseDictRepo.getByBaseDictionaryTypeCodeAndCode(type, code);
            }

            List&lt;CaseRules&gt; caseRules = execution.getVariable("caseRules")
            Long caseId = execution.getVariable("caseId")
            List&lt;BaseDictionary&gt; newRulesBd = execution.getVariable("baseDictionaries")
                List&lt;BaseDictionary&gt; newRulesLocal = []
                def existsRule = []
                def newRules = []

                caseRules.forEach({ c -&gt;
                if(c.ruleId != null)
                existsRule.add(c.ruleId.id)
                })

                newRulesBd.forEach({ bd -&gt;
                if (!existsRule.contains(bd.getId())) {
                newRulesLocal.add(bd)
                }
                })

                newRulesLocal.forEach({bd-&gt;
                CaseRules cr = new CaseRules();
                Case aCase = new Case();
            aCase.setId(caseId);
            cr.setRuleId(bd)
            cr.setCaseId(aCase)
            cr.code = getBd(75, "6001")
            newRules.add(cr)
            })

            execution.setVariable("newRules",newRules)
          </bpmn:script>
        </bpmn:scriptTask>
        <bpmn:serviceTask id="Activity_18uh03o" name="Сохранить&#10;CASERULES" camunda:delegateExpression="${saveObjectListDelegate}">
          <bpmn:extensionElements>
            <camunda:inputOutput>
              <camunda:inputParameter name="outputVarName">newRules</camunda:inputParameter>
              <camunda:inputParameter name="saveObjectList">${newRules}</camunda:inputParameter>
            </camunda:inputOutput>
          </bpmn:extensionElements>
          <bpmn:incoming>Flow_1i4u616</bpmn:incoming>
          <bpmn:outgoing>Flow_14kdyzj</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:endEvent id="Event_1t45a4a">
          <bpmn:incoming>Flow_14kdyzj</bpmn:incoming>
        </bpmn:endEvent>
        <bpmn:serviceTask id="Activity_1d0pkbr" name="Логирование процесса" camunda:delegateExpression="${loggerDelegate}">
          <bpmn:incoming>Flow_0o8qg6a</bpmn:incoming>
          <bpmn:outgoing>Flow_1gnbiyl</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:serviceTask id="Activity_01jw7yf" name="Логирование процесса" camunda:delegateExpression="${loggerDelegate}">
          <bpmn:incoming>Flow_1p9npa3</bpmn:incoming>
          <bpmn:outgoing>Flow_1i4u616</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:serviceTask id="Activity_00iazqm" name="Логирование процесса" camunda:delegateExpression="${loggerDelegate}">
          <bpmn:incoming>Flow_0qbk3gz</bpmn:incoming>
          <bpmn:outgoing>Flow_0kfq50q</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:sequenceFlow id="Flow_1gnbiyl" sourceRef="Activity_1d0pkbr" targetRef="Activity_1c009cx" />
        <bpmn:sequenceFlow id="Flow_0qbk3gz" sourceRef="Activity_1c009cx" targetRef="Activity_00iazqm" />
        <bpmn:sequenceFlow id="Flow_0kfq50q" sourceRef="Activity_00iazqm" targetRef="Activity_1y52sob" />
        <bpmn:sequenceFlow id="Flow_1p9npa3" sourceRef="Activity_1y52sob" targetRef="Activity_01jw7yf" />
        <bpmn:sequenceFlow id="Flow_1i4u616" sourceRef="Activity_01jw7yf" targetRef="Activity_18uh03o" />
        <bpmn:sequenceFlow id="Flow_14kdyzj" sourceRef="Activity_18uh03o" targetRef="Event_1t45a4a" />
        <bpmn:sequenceFlow id="Flow_0o8qg6a" sourceRef="Activity_0q1u7ac" targetRef="Activity_1d0pkbr" />
      </bpmn:subProcess>
      <bpmn:serviceTask id="Activity_1i6h2cw" name="EndTransactionDelegate" camunda:delegateExpression="${endTransactionDelegate}">
        <bpmn:incoming>Flow_1xc0rm5</bpmn:incoming>
        <bpmn:outgoing>Flow_12kd06o</bpmn:outgoing>
      </bpmn:serviceTask>
      <bpmn:sequenceFlow id="Flow_1xc0rm5" sourceRef="Activity_0y09n4q" targetRef="Activity_1i6h2cw" />
      <bpmn:endEvent id="Event_0rslf45">
        <bpmn:incoming>Flow_1x1l9mb</bpmn:incoming>
      </bpmn:endEvent>
      <bpmn:sequenceFlow id="Flow_12kd06o" sourceRef="Activity_1i6h2cw" targetRef="Activity_1cpt2gg" />
      <bpmn:subProcess id="Activity_1qhqh1c">
        <bpmn:incoming>Flow_0sq65hq</bpmn:incoming>
        <bpmn:outgoing>Flow_1o50puf</bpmn:outgoing>
        <bpmn:startEvent id="Event_08vq00w">
          <bpmn:outgoing>Flow_06fmxl5</bpmn:outgoing>
        </bpmn:startEvent>
        <bpmn:scriptTask id="Activity_1sz0i2r" name="Проставляем переменные кейса" scriptFormat="groovy">
          <bpmn:incoming>Flow_06fmxl5</bpmn:incoming>
          <bpmn:outgoing>Flow_1ar0vf8</bpmn:outgoing>
          <bpmn:script>def acceptedCodes = []
            def baseDictionaries = execution.getVariable("baseDictionaries")

            execution.setVariable("caseType", "4")
            execution.setVariable("acceptedRules", baseDictionaries)
            execution.setVariable("acceptedCodes", acceptedCodes)
          </bpmn:script>
        </bpmn:scriptTask>
        <bpmn:serviceTask id="Activity_15hckls" name="Логирование процесса" camunda:delegateExpression="${loggerDelegate}">
          <bpmn:incoming>Flow_1ar0vf8</bpmn:incoming>
          <bpmn:outgoing>Flow_0ob5szp</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:sequenceFlow id="Flow_06fmxl5" sourceRef="Event_08vq00w" targetRef="Activity_1sz0i2r" />
        <bpmn:sequenceFlow id="Flow_1ar0vf8" sourceRef="Activity_1sz0i2r" targetRef="Activity_15hckls" />
        <bpmn:serviceTask id="Activity_06urcbs" name="EndTransactionDelegate" camunda:delegateExpression="${endTransactionDelegate}">
          <bpmn:incoming>Flow_0ob5szp</bpmn:incoming>
          <bpmn:outgoing>Flow_1tccoe5</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:callActivity id="Activity_createCase" name="Формирование кейса" calledElement="caseCreate">
          <bpmn:extensionElements>
            <camunda:in source="payment" target="payment" />
            <camunda:in source="session" target="session" />
            <camunda:in source="acceptedRules" target="acceptedRules" />
            <camunda:in source="caseType" target="caseType" />
            <camunda:in source="acceptedCodes" target="acceptedCodes" />
            <camunda:in businessKey="#{execution.processBusinessKey}" />
          </bpmn:extensionElements>
          <bpmn:incoming>Flow_1tccoe5</bpmn:incoming>
          <bpmn:outgoing>Flow_1g2ppru</bpmn:outgoing>
        </bpmn:callActivity>
        <bpmn:sequenceFlow id="Flow_0ob5szp" sourceRef="Activity_15hckls" targetRef="Activity_06urcbs" />
        <bpmn:sequenceFlow id="Flow_1tccoe5" sourceRef="Activity_06urcbs" targetRef="Activity_createCase" />
        <bpmn:endEvent id="Event_1nr78u6">
          <bpmn:incoming>Flow_1g2ppru</bpmn:incoming>
        </bpmn:endEvent>
        <bpmn:sequenceFlow id="Flow_1g2ppru" sourceRef="Activity_createCase" targetRef="Event_1nr78u6" />
      </bpmn:subProcess>
      <bpmn:endEvent id="Event_0n49gcy">
        <bpmn:incoming>Flow_1o50puf</bpmn:incoming>
      </bpmn:endEvent>
      <bpmn:serviceTask id="Activity_1cpt2gg" name="Закрыть сессию" camunda:delegateExpression="${closeSessionRnkbDelegate}">
        <bpmn:incoming>Flow_12kd06o</bpmn:incoming>
        <bpmn:outgoing>Flow_1x1l9mb</bpmn:outgoing>
      </bpmn:serviceTask>
      <bpmn:sequenceFlow id="Flow_1x1l9mb" sourceRef="Activity_1cpt2gg" targetRef="Event_0rslf45" />
      <bpmn:serviceTask id="Activity_1cxizrl" name="Закрыть сессию" camunda:delegateExpression="${closeSessionRnkbDelegate}">
        <bpmn:incoming>Flow_0lrcrgx</bpmn:incoming>
        <bpmn:outgoing>Flow_0udljpz</bpmn:outgoing>
      </bpmn:serviceTask>
      <bpmn:sequenceFlow id="Flow_0udljpz" sourceRef="Activity_1cxizrl" targetRef="Event_0i1b2fj" />
      <bpmn:exclusiveGateway id="Gateway_0g988kc" default="Flow_0j54stc">
        <bpmn:incoming>Flow_1y3pmfd</bpmn:incoming>
        <bpmn:outgoing>Flow_0sq65hq</bpmn:outgoing>
        <bpmn:outgoing>Flow_0j54stc</bpmn:outgoing>
      </bpmn:exclusiveGateway>
      <bpmn:sequenceFlow id="Flow_1ygeyrt" sourceRef="Gateway_1w23zc6" targetRef="Gateway_1rizclj" />
      <bpmn:sequenceFlow id="Flow_0sq65hq" name="Offline" sourceRef="Gateway_0g988kc" targetRef="Activity_1qhqh1c">
        <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${"Offline".equalsIgnoreCase(paymentCheckType)}</bpmn:conditionExpression>
      </bpmn:sequenceFlow>
      <bpmn:subProcess id="Activity_15tbnk7">
        <bpmn:incoming>Flow_0j54stc</bpmn:incoming>
        <bpmn:outgoing>Flow_08af9ro</bpmn:outgoing>
        <bpmn:startEvent id="Event_0lgmd6v">
          <bpmn:outgoing>Flow_1a2s3om</bpmn:outgoing>
        </bpmn:startEvent>
        <bpmn:scriptTask id="Activity_1c5cpsh" name="Проставляем переменные кейса" scriptFormat="groovy">
          <bpmn:incoming>Flow_1a2s3om</bpmn:incoming>
          <bpmn:outgoing>Flow_0wjmsrz</bpmn:outgoing>
          <bpmn:script>def acceptedCodes = []
            def baseDictionaries = execution.getVariable("baseDictionaries")

            execution.setVariable("caseType", "3")
            execution.setVariable("acceptedRules", baseDictionaries)
            execution.setVariable("acceptedCodes", acceptedCodes)
          </bpmn:script>
        </bpmn:scriptTask>
        <bpmn:serviceTask id="Activity_0x6px15" name="Логирование процесса" camunda:delegateExpression="${loggerDelegate}">
          <bpmn:incoming>Flow_0wjmsrz</bpmn:incoming>
          <bpmn:outgoing>Flow_0ylrugl</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:serviceTask id="Activity_13ng4pl" name="EndTransactionDelegate" camunda:delegateExpression="${endTransactionDelegate}">
          <bpmn:incoming>Flow_1r6vyt1</bpmn:incoming>
          <bpmn:outgoing>Flow_1poj9km</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:endEvent id="Event_1mynaur">
          <bpmn:incoming>Flow_1poj9km</bpmn:incoming>
        </bpmn:endEvent>
        <bpmn:sequenceFlow id="Flow_1a2s3om" sourceRef="Event_0lgmd6v" targetRef="Activity_1c5cpsh" />
        <bpmn:sequenceFlow id="Flow_0wjmsrz" sourceRef="Activity_1c5cpsh" targetRef="Activity_0x6px15" />
        <bpmn:sequenceFlow id="Flow_1poj9km" sourceRef="Activity_13ng4pl" targetRef="Event_1mynaur" />
        <bpmn:scriptTask id="Activity_1ond2rr" name="Формирование case" scriptFormat="groovy">
          <bpmn:incoming>Flow_0ylrugl</bpmn:incoming>
          <bpmn:outgoing>Flow_1mc1fcl</bpmn:outgoing>
          <bpmn:script>import com.prime.db.rnkb.model.Case
import com.prime.db.rnkb.model.BaseDictionary
import com.prime.db.rnkb.model.SysUser

import java.time.LocalDateTime

BaseDictionary getBd(int type, String code) {
    baseDictRepo.getByBaseDictionaryTypeCodeAndCode(type, code);
}

def caseType = execution.getVariable("caseType");
def user = execution.getVariable("user");

SysUser getResponsibleUser(String roleCharCode) {
    List&lt;SysUser&gt; sysUserList = sysUserRoleRepository.findSysUsersByRoleCharCode(roleCharCode)
    return !sysUserList.isEmpty() ? sysUserList.first() : null
}

def status = null
def caseStatus = null

Case caseData = new Case()
status = getBd(131, "1")
caseStatus = getBd(178, "1")
caseData.name = "Online monitoring"
caseData.caseObjectType = getBd(14, "2")

caseData.setCreationdate(LocalDateTime.now())
caseData.setCaseType(getBd(18, caseType))
caseData.author = user
caseData.status = status
caseData.caseStatus = caseStatus
caseData.responsibleUser = getResponsibleUser("aml_supervisor_so")

execution.setVariable("caseData", caseData)</bpmn:script>
        </bpmn:scriptTask>
        <bpmn:sequenceFlow id="Flow_0ylrugl" sourceRef="Activity_0x6px15" targetRef="Activity_1ond2rr" />
        <bpmn:serviceTask id="Activity_saveCase" name="Сохранить&#10;Case" camunda:delegateExpression="${saveObjectDelegate}">
          <bpmn:extensionElements>
            <camunda:inputOutput>
              <camunda:inputParameter name="outputVarName">caseDataOut</camunda:inputParameter>
              <camunda:inputParameter name="saveObject">${caseData}</camunda:inputParameter>
            </camunda:inputOutput>
          </bpmn:extensionElements>
          <bpmn:incoming>Flow_1mc1fcl</bpmn:incoming>
          <bpmn:outgoing>Flow_1oqwvec</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:scriptTask id="Activity_caseRelations" name="Формирование case, связанные данные" scriptFormat="groovy" camunda:resultVariable="caseData">
          <bpmn:incoming>Flow_1oqwvec</bpmn:incoming>
          <bpmn:outgoing>Flow_1u09zhl</bpmn:outgoing>
          <bpmn:script>import com.prime.db.rnkb.model.CaseOperation
            import com.prime.db.rnkb.model.CaseRules
            import com.prime.db.rnkb.model.CaseComment
            import com.prime.db.rnkb.model.BaseDictionary
            import java.time.LocalDateTime

            boolean isCodeLower34(String code) {
            return (code as int) &lt; 34;
            }

            BaseDictionary getBd(int type, String code) {
            baseDictRepo.getByBaseDictionaryTypeCodeAndCode(type, code);
            }

            def acceptedRules = execution.getVariable("acceptedRules")
            def acceptedCodes = execution.getVariable("acceptedCodes")
            def caseType = execution.getVariable("caseType")
            def payment = execution.getVariable("payment")
            def caseData = execution.getVariable("caseDataOut")

            def comment = execution.getVariable("comment")
            def user = execution.getVariable("user")

// Case rules
def caseRelationList = []

acceptedRules.each{r -&gt;
    CaseRules cr = new CaseRules()
    cr.ruleId = r
    cr.caseId = caseData
    cr.code = getBd(75, "6001")
    caseRelationList.add(cr)
}

acceptedCodes.each{r -&gt;
    CaseRules cr = new CaseRules()
    cr.caseId = caseData
    cr.code = r
    caseRelationList.add(cr)
}

if (caseRelationList.size() == 0 &amp;&amp; caseType == "3") {
    CaseRules rule = new CaseRules()
    rule.caseId = caseData
    rule.code = getBd(75, "6001")
    caseRelationList.add(rule)
}

// Case operation
CaseOperation caseOperation = new CaseOperation()

caseOperation.setCaseId(caseData);
caseOperation.setPaymentId(payment)
caseOperation.setDateoper(payment.getDateIn())
caseOperation.setAmount(payment.getAmountNationalCurrency())

caseOperation.setPayeeaccountnumber(payment.getPayeeAccountNumber())
caseOperation.setPayeraccountnumber(payment.getPayerAccountNumber())

if(payment.getBankPayerId() != null)
    caseOperation.setPayerbankname(payment.getBankPayerId().getName())
if(payment.getBankPayeeId() != null)
    caseOperation.setPayeebankname(payment.getBankPayeeId().getName())
caseOperation.setPayername(payment.getPayerName())
caseOperation.setPayeename(payment.getPayeeName())
caseOperation.setType(payment.getType())
caseOperation.setCurrency(payment.getCurrency())

caseOperation.setPayerClientId(payment.getPayerClientId())
caseOperation.setPayeeClientId(payment.getPayeeClientId())

caseRelationList.add(caseOperation)

// Case comment
if(comment != null) {
    CaseComment caseComment = new CaseComment()

    caseComment.creationDate = LocalDateTime.now()
            caseComment.author = user
            caseComment.caseId = caseData
            caseComment.comment = comment

            caseRelationList.add(caseComment)
            }

            execution.setVariable("caseRelationList", caseRelationList);
        </bpmn:script>
        </bpmn:scriptTask>
        <bpmn:serviceTask id="Activity_saveCaseRelations" name="Сохранить&#10;связанные с case объекты" camunda:delegateExpression="${saveObjectListDelegate}">
          <bpmn:extensionElements>
            <camunda:inputOutput>
              <camunda:inputParameter name="saveObjectList">${caseRelationList}</camunda:inputParameter>
            </camunda:inputOutput>
          </bpmn:extensionElements>
          <bpmn:incoming>Flow_1u09zhl</bpmn:incoming>
          <bpmn:outgoing>Flow_1r6vyt1</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:sequenceFlow id="Flow_1mc1fcl" sourceRef="Activity_1ond2rr" targetRef="Activity_saveCase" />
        <bpmn:sequenceFlow id="Flow_1oqwvec" sourceRef="Activity_saveCase" targetRef="Activity_caseRelations" />
        <bpmn:sequenceFlow id="Flow_1u09zhl" sourceRef="Activity_caseRelations" targetRef="Activity_saveCaseRelations" />
        <bpmn:sequenceFlow id="Flow_1r6vyt1" sourceRef="Activity_saveCaseRelations" targetRef="Activity_13ng4pl" />
      </bpmn:subProcess>
      <bpmn:sequenceFlow id="Flow_0j54stc" name="Online" sourceRef="Gateway_0g988kc" targetRef="Activity_15tbnk7" />
      <bpmn:endEvent id="Event_059luvt">
        <bpmn:incoming>Flow_1nor7bf</bpmn:incoming>
      </bpmn:endEvent>
      <bpmn:subProcess id="Activity_0rct1ii" name="Mandatory">
        <bpmn:incoming>Flow_14dycvc</bpmn:incoming>
        <bpmn:outgoing>Flow_0fxo5b6</bpmn:outgoing>
        <bpmn:startEvent id="Event_00qdhwo">
          <bpmn:outgoing>Flow_0nlms8r</bpmn:outgoing>
        </bpmn:startEvent>
        <bpmn:scriptTask id="Activity_1ngmirm" name="Проставляем переменные кейса" scriptFormat="groovy">
          <bpmn:incoming>Flow_0nlms8r</bpmn:incoming>
          <bpmn:outgoing>Flow_0ppwlzc</bpmn:outgoing>
          <bpmn:script>def acceptedCodes = []
            def baseDictionaries = execution.getVariable("baseDictionaries")

            execution.setVariable("caseType", "2")
            execution.setVariable("acceptedRules", baseDictionaries)
            execution.setVariable("acceptedCodes", acceptedCodes)
          </bpmn:script>
        </bpmn:scriptTask>
        <bpmn:serviceTask id="Activity_0m6ekyc" name="Логирование процесса" camunda:delegateExpression="${loggerDelegate}">
          <bpmn:incoming>Flow_0ppwlzc</bpmn:incoming>
          <bpmn:outgoing>Flow_1rkb2mj</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:serviceTask id="Activity_1ks6abo" name="EndTransactionDelegate" camunda:delegateExpression="${endTransactionDelegate}">
          <bpmn:incoming>Flow_01r3qj1</bpmn:incoming>
          <bpmn:outgoing>Flow_078srsa</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:endEvent id="Event_0ov83yh">
          <bpmn:incoming>Flow_078srsa</bpmn:incoming>
        </bpmn:endEvent>
        <bpmn:scriptTask id="Activity_12ivexd" name="Формирование case" scriptFormat="groovy">
          <bpmn:incoming>Flow_1rkb2mj</bpmn:incoming>
          <bpmn:outgoing>Flow_0dlhpaj</bpmn:outgoing>
          <bpmn:script>import com.prime.db.rnkb.model.Case
import com.prime.db.rnkb.model.BaseDictionary
import com.prime.db.rnkb.model.SysUser
                import java.time.LocalDateTime

                BaseDictionary getBd(int type, String code) {
    baseDictRepo.getByBaseDictionaryTypeCodeAndCode(type, code);
}

SysUser getResponsibleUser(String roleCharCode) {
    List&lt;SysUser&gt; sysUserList = sysUserRoleRepository.findSysUsersByRoleCharCode(roleCharCode)
    return !sysUserList.isEmpty() ? sysUserList.first() : null
}

def caseType = execution.getVariable("caseType");
def user = execution.getVariable("user");

def status = null
def caseStatus = null

Case caseData = new Case()
status = getBd(130, "1")
caseStatus = getBd(177, "1")
caseData.name = "Mandatory control"
caseData.caseObjectType = getBd(14, "2")

caseData.setCreationdate(LocalDateTime.now())
caseData.setCaseType(getBd(18, caseType))
caseData.author = user
caseData.status = status
caseData.caseStatus = caseStatus
caseData.responsibleUser = getResponsibleUser("aml_supervisor_ok")

execution.setVariable("caseData", caseData);</bpmn:script>
        </bpmn:scriptTask>
        <bpmn:serviceTask id="Activity_0sk21b5" name="Сохранить&#10;Case" camunda:delegateExpression="${saveObjectDelegate}">
          <bpmn:extensionElements>
            <camunda:inputOutput>
              <camunda:inputParameter name="outputVarName">caseDataOut</camunda:inputParameter>
              <camunda:inputParameter name="saveObject">${caseData}</camunda:inputParameter>
            </camunda:inputOutput>
          </bpmn:extensionElements>
          <bpmn:incoming>Flow_0dlhpaj</bpmn:incoming>
          <bpmn:outgoing>Flow_18mlxry</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:scriptTask id="Activity_163c1vy" name="Формирование case, связанные данные" scriptFormat="groovy" camunda:resultVariable="caseData">
          <bpmn:incoming>Flow_18mlxry</bpmn:incoming>
          <bpmn:outgoing>Flow_1fvcxex</bpmn:outgoing>
          <bpmn:script>import com.prime.db.rnkb.model.CaseOperation
import com.prime.db.rnkb.model.CaseRules
import com.prime.db.rnkb.model.CaseComment
import com.prime.db.rnkb.model.BaseDictionary
import java.time.LocalDateTime

BaseDictionary getBd(int type, String code) {
    baseDictRepo.getByBaseDictionaryTypeCodeAndCode(type, code);
}

def acceptedRules = execution.getVariable("acceptedRules")
def payment = execution.getVariable("payment")
def caseData = execution.getVariable("caseDataOut")
def comment = execution.getVariable("comment")
def user = execution.getVariable("user")

// Case rules
def caseRelationList = []

acceptedRules.each { r -&gt;
    if (r.code != 6001 &amp;&amp; !(7001..7103).contains(r.code)) {
        CaseRules cr = new CaseRules()
        cr.caseId = caseData
        cr.code = r
        caseRelationList.add(cr)
    }
}

// Case operation
CaseOperation caseOperation = new CaseOperation()

caseOperation.setCaseId(caseData);
caseOperation.setPaymentId(payment)
caseOperation.setDateoper(payment.getDateIn())
caseOperation.setAmount(payment.getAmountNationalCurrency())

caseOperation.setPayeeaccountnumber(payment.getPayeeAccountNumber())
caseOperation.setPayeraccountnumber(payment.getPayerAccountNumber())

if(payment.getBankPayerId() != null)
    caseOperation.setPayerbankname(payment.getBankPayerId().getName())
if(payment.getBankPayeeId() != null)
    caseOperation.setPayeebankname(payment.getBankPayeeId().getName())
caseOperation.setPayername(payment.getPayerName())
caseOperation.setPayeename(payment.getPayeeName())
caseOperation.setType(payment.getType())
caseOperation.setCurrency(payment.getCurrency())

caseOperation.setPayerClientId(payment.getPayerClientId())
caseOperation.setPayeeClientId(payment.getPayeeClientId())

caseRelationList.add(caseOperation)

// Case comment
if(comment != null) {
    CaseComment caseComment = new CaseComment()

    caseComment.creationDate = LocalDateTime.now()
    caseComment.author = user
    caseComment.caseId = caseData
    caseComment.comment = comment

    caseRelationList.add(caseComment)
}

execution.setVariable("caseRelationList", caseRelationList);   </bpmn:script>
        </bpmn:scriptTask>
        <bpmn:serviceTask id="Activity_1u4ct90" name="Сохранить&#10;связанные с case объекты" camunda:delegateExpression="${saveObjectListDelegate}">
          <bpmn:extensionElements>
            <camunda:inputOutput>
              <camunda:inputParameter name="saveObjectList">${caseRelationList}</camunda:inputParameter>
            </camunda:inputOutput>
          </bpmn:extensionElements>
          <bpmn:incoming>Flow_1fvcxex</bpmn:incoming>
          <bpmn:outgoing>Flow_01r3qj1</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:sequenceFlow id="Flow_0nlms8r" sourceRef="Event_00qdhwo" targetRef="Activity_1ngmirm" />
        <bpmn:sequenceFlow id="Flow_0ppwlzc" sourceRef="Activity_1ngmirm" targetRef="Activity_0m6ekyc" />
        <bpmn:sequenceFlow id="Flow_1rkb2mj" sourceRef="Activity_0m6ekyc" targetRef="Activity_12ivexd" />
        <bpmn:sequenceFlow id="Flow_01r3qj1" sourceRef="Activity_1u4ct90" targetRef="Activity_1ks6abo" />
        <bpmn:sequenceFlow id="Flow_078srsa" sourceRef="Activity_1ks6abo" targetRef="Event_0ov83yh" />
        <bpmn:sequenceFlow id="Flow_0dlhpaj" sourceRef="Activity_12ivexd" targetRef="Activity_0sk21b5" />
        <bpmn:sequenceFlow id="Flow_18mlxry" sourceRef="Activity_0sk21b5" targetRef="Activity_163c1vy" />
        <bpmn:sequenceFlow id="Flow_1fvcxex" sourceRef="Activity_163c1vy" targetRef="Activity_1u4ct90" />
      </bpmn:subProcess>
      <bpmn:endEvent id="Event_17gsh4i">
        <bpmn:incoming>Flow_0bwij5y</bpmn:incoming>
      </bpmn:endEvent>
      <bpmn:serviceTask id="Activity_0lqkyzb" name="Закрыть сессию" camunda:delegateExpression="${closeSessionRnkbDelegate}">
        <bpmn:incoming>Flow_08af9ro</bpmn:incoming>
        <bpmn:outgoing>Flow_1nor7bf</bpmn:outgoing>
      </bpmn:serviceTask>
      <bpmn:sequenceFlow id="Flow_08af9ro" sourceRef="Activity_15tbnk7" targetRef="Activity_0lqkyzb" />
      <bpmn:sequenceFlow id="Flow_1nor7bf" sourceRef="Activity_0lqkyzb" targetRef="Event_059luvt" />
      <bpmn:serviceTask id="Activity_1fukk0z" name="Закрыть сессию" camunda:delegateExpression="${closeSessionRnkbDelegate}">
        <bpmn:incoming>Flow_0fxo5b6</bpmn:incoming>
        <bpmn:outgoing>Flow_0bwij5y</bpmn:outgoing>
      </bpmn:serviceTask>
      <bpmn:sequenceFlow id="Flow_0fxo5b6" sourceRef="Activity_0rct1ii" targetRef="Activity_1fukk0z" />
      <bpmn:sequenceFlow id="Flow_0bwij5y" sourceRef="Activity_1fukk0z" targetRef="Event_17gsh4i" />
      <bpmn:sequenceFlow id="Flow_1o50puf" sourceRef="Activity_1qhqh1c" targetRef="Event_0n49gcy" />
      <bpmn:endEvent id="Event_1jji15u">
        <bpmn:incoming>Flow_0t32iji</bpmn:incoming>
      </bpmn:endEvent>
      <bpmn:exclusiveGateway id="Gateway_1lyf2j0" default="Flow_0t32iji">
        <bpmn:incoming>Flow_18wv7q1</bpmn:incoming>
        <bpmn:outgoing>Flow_0t32iji</bpmn:outgoing>
        <bpmn:outgoing>Flow_0ij3i33</bpmn:outgoing>
      </bpmn:exclusiveGateway>
      <bpmn:sequenceFlow id="Flow_0t32iji" sourceRef="Gateway_1lyf2j0" targetRef="Event_1jji15u" />
      <bpmn:sequenceFlow id="Flow_0ij3i33" sourceRef="Gateway_1lyf2j0" targetRef="Gateway_1w23zc6">
        <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${!rules.isEmpty()}</bpmn:conditionExpression>
      </bpmn:sequenceFlow>
      <bpmn:sequenceFlow id="Flow_18wv7q1" sourceRef="Activity_0y6jre5" targetRef="Gateway_1lyf2j0" />
      <bpmn:subProcess id="Activity_0y4debj" name="Suspending">
        <bpmn:incoming>Flow_1kuw6vx</bpmn:incoming>
        <bpmn:outgoing>Flow_091qt4p</bpmn:outgoing>
        <bpmn:startEvent id="Event_0iwxvi0">
          <bpmn:outgoing>Flow_1msxxhj</bpmn:outgoing>
        </bpmn:startEvent>
        <bpmn:scriptTask id="Activity_0hdog1z" name="Проставляем переменные кейса" scriptFormat="groovy">
          <bpmn:incoming>Flow_1msxxhj</bpmn:incoming>
          <bpmn:outgoing>Flow_0p574uz</bpmn:outgoing>
          <bpmn:script>def acceptedCodes = []
            def baseDictionaries = execution.getVariable("baseDictionaries")

            execution.setVariable("caseType", "1")
            execution.setVariable("acceptedRules", baseDictionaries)
            execution.setVariable("acceptedCodes", acceptedCodes)
          </bpmn:script>
        </bpmn:scriptTask>
        <bpmn:serviceTask id="Activity_1w9jji9" name="Логирование процесса" camunda:delegateExpression="${loggerDelegate}">
          <bpmn:incoming>Flow_0p574uz</bpmn:incoming>
          <bpmn:outgoing>Flow_0skjlq0</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:serviceTask id="Activity_1h62s4l" name="EndTransactionDelegate" camunda:delegateExpression="${endTransactionDelegate}">
          <bpmn:incoming>Flow_11y6xut</bpmn:incoming>
          <bpmn:outgoing>Flow_0qwlgtm</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:endEvent id="Event_0yrgdcs">
          <bpmn:incoming>Flow_0qwlgtm</bpmn:incoming>
        </bpmn:endEvent>
        <bpmn:scriptTask id="Activity_1j4ph0e" name="Формирование case" scriptFormat="groovy">
          <bpmn:incoming>Flow_0skjlq0</bpmn:incoming>
          <bpmn:outgoing>Flow_0ewrgb0</bpmn:outgoing>
          <bpmn:script>import com.prime.db.rnkb.model.Case
import com.prime.db.rnkb.model.BaseDictionary
import com.prime.db.rnkb.model.SysUser
                import java.time.LocalDateTime

                BaseDictionary getBd(int type, String code) {
    baseDictRepo.getByBaseDictionaryTypeCodeAndCode(type, code);
}

SysUser getResponsibleUser(String roleCharCode) {
    List&lt;SysUser&gt; sysUserList = sysUserRoleRepository.findSysUsersByRoleCharCode(roleCharCode)
    return !sysUserList.isEmpty() ? sysUserList.first() : null
}

def caseType = execution.getVariable("caseType");
def user = execution.getVariable("user");

def status = null
def caseStatus = null

Case caseData = new Case()
status = getBd(174, "1")
caseStatus = getBd(176, "1")
caseData.name = "Suspending operations"
caseData.caseObjectType = getBd(14, "2")

caseData.setCreationdate(LocalDateTime.now())
caseData.setCaseType(getBd(18, caseType))
caseData.author = user
caseData.status = status
caseData.caseStatus = caseStatus

execution.setVariable("caseData", caseData);</bpmn:script>
        </bpmn:scriptTask>
        <bpmn:serviceTask id="Activity_1wv2275" name="Сохранить&#10;Case" camunda:delegateExpression="${saveObjectDelegate}">
          <bpmn:extensionElements>
            <camunda:inputOutput>
              <camunda:inputParameter name="outputVarName">caseDataOut</camunda:inputParameter>
              <camunda:inputParameter name="saveObject">${caseData}</camunda:inputParameter>
            </camunda:inputOutput>
          </bpmn:extensionElements>
          <bpmn:incoming>Flow_0ewrgb0</bpmn:incoming>
          <bpmn:outgoing>Flow_0fsg058</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:scriptTask id="Activity_0r0bs0s" name="Формирование case, связанные данные" scriptFormat="groovy" camunda:resultVariable="caseData">
          <bpmn:incoming>Flow_0fsg058</bpmn:incoming>
          <bpmn:outgoing>Flow_0k03hzr</bpmn:outgoing>
          <bpmn:script>import com.prime.db.rnkb.model.CaseOperation
import com.prime.db.rnkb.model.CaseRules
import com.prime.db.rnkb.model.CaseComment
import com.prime.db.rnkb.model.BaseDictionary
import java.time.LocalDateTime

BaseDictionary getBd(int type, String code) {
    baseDictRepo.getByBaseDictionaryTypeCodeAndCode(type, code);
}

def acceptedRules = execution.getVariable("acceptedRules")
def payment = execution.getVariable("payment")
def caseData = execution.getVariable("caseDataOut")
def comment = execution.getVariable("comment")
def user = execution.getVariable("user")

// Case rules
def caseRelationList = []

acceptedRules.each { r -&gt;
    if (r.code != 6001 &amp;&amp; !(7001..7103).contains(r.code)) {
        CaseRules cr = new CaseRules()
        cr.caseId = caseData
        cr.code = r
        caseRelationList.add(cr)
    }
}

// Case operation
CaseOperation caseOperation = new CaseOperation()

caseOperation.setCaseId(caseData);
caseOperation.setPaymentId(payment)
caseOperation.setDateoper(payment.getDateIn())
caseOperation.setAmount(payment.getAmountNationalCurrency())

caseOperation.setPayeeaccountnumber(payment.getPayeeAccountNumber())
caseOperation.setPayeraccountnumber(payment.getPayerAccountNumber())

if(payment.getBankPayerId() != null)
    caseOperation.setPayerbankname(payment.getBankPayerId().getName())
if(payment.getBankPayeeId() != null)
    caseOperation.setPayeebankname(payment.getBankPayeeId().getName())
caseOperation.setPayername(payment.getPayerName())
caseOperation.setPayeename(payment.getPayeeName())
caseOperation.setType(payment.getType())
caseOperation.setCurrency(payment.getCurrency())

caseOperation.setPayerClientId(payment.getPayerClientId())
caseOperation.setPayeeClientId(payment.getPayeeClientId())

caseRelationList.add(caseOperation)

// Case comment
if(comment != null) {
    CaseComment caseComment = new CaseComment()

    caseComment.creationDate = LocalDateTime.now()
    caseComment.author = user
    caseComment.caseId = caseData
    caseComment.comment = comment

    caseRelationList.add(caseComment)
}

execution.setVariable("caseRelationList", caseRelationList);</bpmn:script>
        </bpmn:scriptTask>
        <bpmn:serviceTask id="Activity_110zu51" name="Сохранить&#10;связанные с case объекты" camunda:delegateExpression="${saveObjectListDelegate}">
          <bpmn:extensionElements>
            <camunda:inputOutput>
              <camunda:inputParameter name="saveObjectList">${caseRelationList}</camunda:inputParameter>
            </camunda:inputOutput>
          </bpmn:extensionElements>
          <bpmn:incoming>Flow_0k03hzr</bpmn:incoming>
          <bpmn:outgoing>Flow_11y6xut</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:sequenceFlow id="Flow_1msxxhj" sourceRef="Event_0iwxvi0" targetRef="Activity_0hdog1z" />
        <bpmn:sequenceFlow id="Flow_0p574uz" sourceRef="Activity_0hdog1z" targetRef="Activity_1w9jji9" />
        <bpmn:sequenceFlow id="Flow_0skjlq0" sourceRef="Activity_1w9jji9" targetRef="Activity_1j4ph0e" />
        <bpmn:sequenceFlow id="Flow_11y6xut" sourceRef="Activity_110zu51" targetRef="Activity_1h62s4l" />
        <bpmn:sequenceFlow id="Flow_0qwlgtm" sourceRef="Activity_1h62s4l" targetRef="Event_0yrgdcs" />
        <bpmn:sequenceFlow id="Flow_0ewrgb0" sourceRef="Activity_1j4ph0e" targetRef="Activity_1wv2275" />
        <bpmn:sequenceFlow id="Flow_0fsg058" sourceRef="Activity_1wv2275" targetRef="Activity_0r0bs0s" />
        <bpmn:sequenceFlow id="Flow_0k03hzr" sourceRef="Activity_0r0bs0s" targetRef="Activity_110zu51" />
      </bpmn:subProcess>
      <bpmn:endEvent id="Event_0wjyn88">
        <bpmn:incoming>Flow_1kun2p7</bpmn:incoming>
      </bpmn:endEvent>
      <bpmn:serviceTask id="Activity_1s612px" name="Закрыть сессию" camunda:delegateExpression="${closeSessionRnkbDelegate}">
        <bpmn:incoming>Flow_091qt4p</bpmn:incoming>
        <bpmn:outgoing>Flow_1kun2p7</bpmn:outgoing>
      </bpmn:serviceTask>
      <bpmn:sequenceFlow id="Flow_091qt4p" sourceRef="Activity_0y4debj" targetRef="Activity_1s612px" />
      <bpmn:sequenceFlow id="Flow_1kun2p7" sourceRef="Activity_1s612px" targetRef="Event_0wjyn88" />
      <bpmn:exclusiveGateway id="Gateway_1rizclj" default="Flow_1y3pmfd">
        <bpmn:incoming>Flow_1ygeyrt</bpmn:incoming>
        <bpmn:outgoing>Flow_1y3pmfd</bpmn:outgoing>
        <bpmn:outgoing>Flow_03novcb</bpmn:outgoing>
      </bpmn:exclusiveGateway>
      <bpmn:sequenceFlow id="Flow_1y3pmfd" sourceRef="Gateway_1rizclj" targetRef="Gateway_0g988kc" />
      <bpmn:exclusiveGateway id="Gateway_0zgvx0e" default="Flow_1kuw6vx">
        <bpmn:incoming>Flow_03novcb</bpmn:incoming>
        <bpmn:outgoing>Flow_1kuw6vx</bpmn:outgoing>
        <bpmn:outgoing>Flow_14dycvc</bpmn:outgoing>
      </bpmn:exclusiveGateway>
      <bpmn:sequenceFlow id="Flow_03novcb" name="isOpok?" sourceRef="Gateway_1rizclj" targetRef="Gateway_0zgvx0e">
        <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${isOpok}</bpmn:conditionExpression>
      </bpmn:sequenceFlow>
      <bpmn:sequenceFlow id="Flow_1kuw6vx" sourceRef="Gateway_0zgvx0e" targetRef="Activity_0y4debj" />
      <bpmn:sequenceFlow id="Flow_14dycvc" name="Offline?" sourceRef="Gateway_0zgvx0e" targetRef="Activity_0rct1ii">
        <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${"Offline".equalsIgnoreCase(paymentCheckType)}</bpmn:conditionExpression>
      </bpmn:sequenceFlow>
      <bpmn:subProcess id="Activity_0zf4qnr">
        <bpmn:incoming>Flow_1kone15</bpmn:incoming>
        <bpmn:outgoing>Flow_02rswm3</bpmn:outgoing>
        <bpmn:startEvent id="Event_1n9iz26">
          <bpmn:outgoing>Flow_0nfurhh</bpmn:outgoing>
        </bpmn:startEvent>
        <bpmn:scriptTask id="Activity_0i4y7ua" name="Проставляем переменные для CASERULES" scriptFormat="groovy">
          <bpmn:incoming>Flow_0nfurhh</bpmn:incoming>
          <bpmn:outgoing>Flow_1ug0udl</bpmn:outgoing>
          <bpmn:script>import com.prime.db.rnkb.model.CaseOperation

            List&lt;CaseOperation&gt; caseOperation = execution.getVariable("caseOperations")
            Long caseId = caseOperation.get(0).getCaseId().getId()
            execution.setVariable("caseId", caseId)
          </bpmn:script>
        </bpmn:scriptTask>
        <bpmn:serviceTask id="Activity_0a04a0j" name="Получаем список отработавших правил" camunda:delegateExpression="${selectDelegate}">
          <bpmn:extensionElements>
            <camunda:inputOutput>
              <camunda:inputParameter name="selectQuery">select cr from CaseRules cr where cr.caseId = ${caseId}
              </camunda:inputParameter>
              <camunda:inputParameter name="outputVarName">caseRules</camunda:inputParameter>
            </camunda:inputOutput>
          </bpmn:extensionElements>
          <bpmn:incoming>Flow_1x04pd3</bpmn:incoming>
          <bpmn:outgoing>Flow_0msxmtm</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:scriptTask id="Activity_18k3idl" name="Формируем новые CASERULES" scriptFormat="groovy">
          <bpmn:incoming>Flow_132eatj</bpmn:incoming>
          <bpmn:outgoing>Flow_0llw01f</bpmn:outgoing>
          <bpmn:script>import com.prime.db.rnkb.model.BaseDictionary
import com.prime.db.rnkb.model.Case
import com.prime.db.rnkb.model.CaseRules

BaseDictionary getBd(int type, String code) {
    baseDictRepo.getByBaseDictionaryTypeCodeAndCode(type, code);
}

List&lt;CaseRules&gt; caseRules = execution.getVariable("caseRules")
Long caseId = execution.getVariable("caseId")
List&lt;BaseDictionary&gt; newRulesBd = execution.getVariable("baseDictionaries")
List&lt;BaseDictionary&gt; newRulesLocal = []
def existsRule = []
def newRules = []

caseRules.forEach({ c -&gt;
    if(c.code != null)
        existsRule.add(c.code.id)
})

newRulesBd.forEach({ bd -&gt;
    if (!existsRule.contains(bd.getId())) {
        newRulesLocal.add(bd)
    }
})

newRulesLocal.forEach({bd-&gt;
    if (bd.code != 6001 &amp;&amp; !(7001..7103).contains(bd.code)) {
        CaseRules cr = new CaseRules()
        Case aCase = new Case()
        aCase.setId(caseId)
        cr.setCaseId(aCase)
        cr.code = bd
        newRules.add(cr)
    }
})

execution.setVariable("newRules",newRules)
</bpmn:script>
        </bpmn:scriptTask>
        <bpmn:serviceTask id="Activity_105ohr9" name="Сохранить&#10;CASERULES" camunda:delegateExpression="${saveObjectListDelegate}">
          <bpmn:extensionElements>
            <camunda:inputOutput>
              <camunda:inputParameter name="outputVarName">newRules</camunda:inputParameter>
              <camunda:inputParameter name="saveObjectList">${newRules}</camunda:inputParameter>
            </camunda:inputOutput>
          </bpmn:extensionElements>
          <bpmn:incoming>Flow_1awns9y</bpmn:incoming>
          <bpmn:outgoing>Flow_0s9va49</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:endEvent id="Event_193dy07">
          <bpmn:incoming>Flow_0s9va49</bpmn:incoming>
        </bpmn:endEvent>
        <bpmn:serviceTask id="Activity_01gaq8m" name="Логирование процесса" camunda:delegateExpression="${loggerDelegate}">
          <bpmn:incoming>Flow_1ug0udl</bpmn:incoming>
          <bpmn:outgoing>Flow_1x04pd3</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:serviceTask id="Activity_0qkcfzr" name="Логирование процесса" camunda:delegateExpression="${loggerDelegate}">
          <bpmn:incoming>Flow_0llw01f</bpmn:incoming>
          <bpmn:outgoing>Flow_1awns9y</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:serviceTask id="Activity_0v8so4x" name="Логирование процесса" camunda:delegateExpression="${loggerDelegate}">
          <bpmn:incoming>Flow_0msxmtm</bpmn:incoming>
          <bpmn:outgoing>Flow_132eatj</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:sequenceFlow id="Flow_0nfurhh" sourceRef="Event_1n9iz26" targetRef="Activity_0i4y7ua" />
        <bpmn:sequenceFlow id="Flow_1ug0udl" sourceRef="Activity_0i4y7ua" targetRef="Activity_01gaq8m" />
        <bpmn:sequenceFlow id="Flow_1x04pd3" sourceRef="Activity_01gaq8m" targetRef="Activity_0a04a0j" />
        <bpmn:sequenceFlow id="Flow_0msxmtm" sourceRef="Activity_0a04a0j" targetRef="Activity_0v8so4x" />
        <bpmn:sequenceFlow id="Flow_132eatj" sourceRef="Activity_0v8so4x" targetRef="Activity_18k3idl" />
        <bpmn:sequenceFlow id="Flow_0llw01f" sourceRef="Activity_18k3idl" targetRef="Activity_0qkcfzr" />
        <bpmn:sequenceFlow id="Flow_1awns9y" sourceRef="Activity_0qkcfzr" targetRef="Activity_105ohr9" />
        <bpmn:sequenceFlow id="Flow_0s9va49" sourceRef="Activity_105ohr9" targetRef="Event_193dy07" />
      </bpmn:subProcess>
      <bpmn:serviceTask id="Activity_05lznp0" name="EndTransactionDelegate" camunda:delegateExpression="${endTransactionDelegate}">
        <bpmn:incoming>Flow_02rswm3</bpmn:incoming>
        <bpmn:outgoing>Flow_05e6hx0</bpmn:outgoing>
      </bpmn:serviceTask>
      <bpmn:endEvent id="Event_06yax0h">
        <bpmn:incoming>Flow_13tlp5a</bpmn:incoming>
      </bpmn:endEvent>
      <bpmn:serviceTask id="Activity_07cy1pd" name="Закрыть сессию" camunda:delegateExpression="${closeSessionRnkbDelegate}">
        <bpmn:incoming>Flow_05e6hx0</bpmn:incoming>
        <bpmn:outgoing>Flow_13tlp5a</bpmn:outgoing>
      </bpmn:serviceTask>
      <bpmn:sequenceFlow id="Flow_02rswm3" sourceRef="Activity_0zf4qnr" targetRef="Activity_05lznp0" />
      <bpmn:sequenceFlow id="Flow_05e6hx0" sourceRef="Activity_05lznp0" targetRef="Activity_07cy1pd" />
      <bpmn:sequenceFlow id="Flow_13tlp5a" sourceRef="Activity_07cy1pd" targetRef="Event_06yax0h" />
      <bpmn:exclusiveGateway id="Gateway_13y3dcn" default="Flow_0nowm6h">
        <bpmn:incoming>Flow_1k9y2g5</bpmn:incoming>
        <bpmn:outgoing>Flow_0nowm6h</bpmn:outgoing>
        <bpmn:outgoing>Flow_1kone15</bpmn:outgoing>
      </bpmn:exclusiveGateway>
      <bpmn:sequenceFlow id="Flow_0nowm6h" sourceRef="Gateway_13y3dcn" targetRef="Activity_0y09n4q" />
      <bpmn:sequenceFlow id="Flow_1kone15" name="isOpok?" sourceRef="Gateway_13y3dcn" targetRef="Activity_0zf4qnr">
        <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${isOpok}</bpmn:conditionExpression>
      </bpmn:sequenceFlow>
    </bpmn:subProcess>
    <bpmn:sequenceFlow id="Flow_10kplv5" sourceRef="Activity_1qwn6qf" targetRef="Activity_1ax5jfs" />
    <bpmn:endEvent id="Event_1javps5">
      <bpmn:incoming>Flow_0kf9713</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="Flow_0kf9713" sourceRef="Activity_1ax5jfs" targetRef="Event_1javps5" />
    <bpmn:textAnnotation id="TextAnnotation_049rt3r">
      <bpmn:text>payload (JSON)


        PAYMENT.EXID
        Массив кодов сработавших сценариев из справочника 75 Перечень видов операций, сведения о которых
        представляются в уполномоченный орган (Росфинмониторинг)
      </bpmn:text>
    </bpmn:textAnnotation>
    <bpmn:association id="Association_0fu882p" sourceRef="TextAnnotation_049rt3r" targetRef="Event_0zdf9e0" />
    <bpmn:textAnnotation id="TextAnnotation_0ho7fj0" />
    <bpmn:association id="Association_10u5pyr" sourceRef="Activity_1jae6rb" targetRef="TextAnnotation_0ho7fj0" />
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="amlPaymentCasePostBatch">
      <bpmndi:BPMNShape id="Activity_1qwn6qf_di" bpmnElement="Activity_1qwn6qf">
        <dc:Bounds x="990" y="550" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_payload_di" bpmnElement="amlPaymentCasePostBatch_checkOffline">
        <dc:Bounds x="520" y="550" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_0bv2yc6_di" bpmnElement="Event_0zdf9e0">
        <dc:Bounds x="304" y="572" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="279" y="615" width="87" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1jae6rb_di" bpmnElement="Activity_1jae6rb">
        <dc:Bounds x="370" y="550" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_06ifbzj_di" bpmnElement="Activity_06ifbzj">
        <dc:Bounds x="690" y="550" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1ax5jfs_di" bpmnElement="Activity_1ax5jfs" isExpanded="true">
        <dc:Bounds x="1270" y="80" width="4230" height="1630" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_09gh81j_di" bpmnElement="Event_09gh81j">
        <dc:Bounds x="1310" y="396" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0pogohz_di" bpmnElement="Activity_0pogohz">
        <dc:Bounds x="1390" y="374" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_0lrgkkq_di" bpmnElement="Gateway_0lrgkkq" isMarkerVisible="true">
        <dc:Bounds x="1545" y="389" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_129eoh6_di" bpmnElement="Activity_0ba416y">
        <dc:Bounds x="1650" y="374" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_0i1b2fj_di" bpmnElement="Event_0i1b2fj">
        <dc:Bounds x="1552" y="702" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1ik6fij_di" bpmnElement="Activity_1ik6fij">
        <dc:Bounds x="1800" y="374" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0sbdk1p_di" bpmnElement="Activity_0sbdk1p">
        <dc:Bounds x="1950" y="374" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_0n49gcy_di" bpmnElement="Event_0n49gcy">
        <dc:Bounds x="2972" y="1562" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1gyihnn" bpmnElement="Event_17gsh4i">
        <dc:Bounds x="5382" y="1052" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1fukk0z_di" bpmnElement="Activity_1fukk0z">
        <dc:Bounds x="5350" y="910" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_02mthgb" bpmnElement="Event_0wjyn88">
        <dc:Bounds x="5022" y="1492" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1si9ih8" bpmnElement="Activity_1s612px">
        <dc:Bounds x="4990" y="1350" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_0g988kc_di" bpmnElement="Gateway_0g988kc" isMarkerVisible="true">
        <dc:Bounds x="2863" y="675" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_1rizclj_di" bpmnElement="Gateway_1rizclj" isMarkerVisible="true">
        <dc:Bounds x="3785" y="675" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_0zgvx0e_di" bpmnElement="Gateway_0zgvx0e" isMarkerVisible="true">
        <dc:Bounds x="3905" y="675" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1v9bm3a" bpmnElement="Activity_05lznp0">
        <dc:Bounds x="5170" y="514" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1mkihnl" bpmnElement="Event_06yax0h">
        <dc:Bounds x="5432" y="536" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_12d9857" bpmnElement="Activity_07cy1pd">
        <dc:Bounds x="5300" y="514" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_0uenqt7" bpmnElement="Activity_1i6h2cw">
        <dc:Bounds x="5170" y="194" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_0rslf45_di" bpmnElement="Event_0rslf45">
        <dc:Bounds x="5432" y="216" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1ue267h" bpmnElement="Activity_1cpt2gg">
        <dc:Bounds x="5290" y="194" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_13y3dcn_di" bpmnElement="Gateway_13y3dcn" isMarkerVisible="true">
        <dc:Bounds x="3905" y="405" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0y6jre5_di" bpmnElement="Activity_0y6jre5" isExpanded="true">
        <dc:Bounds x="2130" y="140" width="1470" height="430" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0ac15qt_di" bpmnElement="Activity_0ac15qt">
        <dc:Bounds x="2680" y="456" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_1xo0egh_di" bpmnElement="Event_1xo0egh">
        <dc:Bounds x="2588" y="478" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_0xdp0cp_di" bpmnElement="Gateway_0xdp0cp" isMarkerVisible="true">
        <dc:Bounds x="2802" y="419" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2894" y="340" width="71" height="40" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1sh6ujl" bpmnElement="Gateway_1nm5pa4" isMarkerVisible="true">
        <dc:Bounds x="2802" y="325" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_0g5akk9_di" bpmnElement="Gateway_0g5akk9" isMarkerVisible="true">
        <dc:Bounds x="2802" y="235" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0i1xzu6_di" bpmnElement="Activity_0k69n9y">
        <dc:Bounds x="2920" y="472" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1kupixq_di" bpmnElement="Activity_1kupixq">
        <dc:Bounds x="2920" y="370" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_0o8ftuw" bpmnElement="Activity_1ps26i8">
        <dc:Bounds x="2920" y="160" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1y1bckl" bpmnElement="Activity_09ve2ej">
        <dc:Bounds x="2920" y="263" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0swjfxj_di" bpmnElement="Activity_07j6bfd">
        <dc:Bounds x="3100" y="210" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1me8mag" bpmnElement="Activity_0wpxlpx">
        <dc:Bounds x="3100" y="420" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1fy6wj9_di" bpmnElement="Activity_0msip7o">
        <dc:Bounds x="3250" y="310" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1ut6v4x_di" bpmnElement="Activity_1ut6v4x">
        <dc:Bounds x="3390" y="310" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_1wlrkve_di" bpmnElement="Event_1wlrkve">
        <dc:Bounds x="3532" y="332" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_0uv73k4_di" bpmnElement="Event_0uv73k4">
        <dc:Bounds x="2170" y="332" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1pin8eb_di" bpmnElement="Activity_1pin8eb">
        <dc:Bounds x="2260" y="310" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1t7r7o9_di" bpmnElement="Activity_0cq427x">
        <dc:Bounds x="2420" y="310" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_06zjzpv_di" bpmnElement="Activity_06zjzpv">
        <dc:Bounds x="2560" y="310" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_1l60qlp_di" bpmnElement="Gateway_1l60qlp" isMarkerVisible="true">
        <dc:Bounds x="2705" y="325" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_0hbn0y4_di" bpmnElement="Flow_0hbn0y4">
        <di:waypoint x="2755" y="350" />
        <di:waypoint x="2802" y="350" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1ee305x_di" bpmnElement="Flow_1ee305x">
        <di:waypoint x="2852" y="444" />
        <di:waypoint x="2891" y="444" />
        <di:waypoint x="2891" y="410" />
        <di:waypoint x="2920" y="410" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2853" y="397" width="38" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1jhn9vk_di" bpmnElement="Flow_1jhn9vk">
        <di:waypoint x="2827" y="469" />
        <di:waypoint x="2827" y="512" />
        <di:waypoint x="2920" y="512" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2851" y="482" width="38" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_11sng6b_di" bpmnElement="Flow_11sng6b">
        <di:waypoint x="2730" y="375" />
        <di:waypoint x="2730" y="456" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1yyl630_di" bpmnElement="Flow_1yyl630">
        <di:waypoint x="2680" y="496" />
        <di:waypoint x="2624" y="496" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_08rzw6c_di" bpmnElement="Flow_08rzw6c">
        <di:waypoint x="2827" y="375" />
        <di:waypoint x="2827" y="419" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1bknnpw_di" bpmnElement="Flow_1bknnpw">
        <di:waypoint x="2827" y="325" />
        <di:waypoint x="2827" y="285" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2774" y="302" width="46" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_008r5kq_di" bpmnElement="Flow_008r5kq">
        <di:waypoint x="2827" y="235" />
        <di:waypoint x="2827" y="200" />
        <di:waypoint x="2920" y="200" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2853" y="175" width="38" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1g4fcwc_di" bpmnElement="Flow_1g4fcwc">
        <di:waypoint x="2852" y="260" />
        <di:waypoint x="2886" y="260" />
        <di:waypoint x="2886" y="303" />
        <di:waypoint x="2920" y="303" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2863" y="319" width="38" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1tl0ep9_di" bpmnElement="Flow_1tl0ep9">
        <di:waypoint x="3020" y="303" />
        <di:waypoint x="3060" y="303" />
        <di:waypoint x="3060" y="250" />
        <di:waypoint x="3100" y="250" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_11vob8m_di" bpmnElement="Flow_11vob8m">
        <di:waypoint x="3020" y="200" />
        <di:waypoint x="3060" y="200" />
        <di:waypoint x="3060" y="250" />
        <di:waypoint x="3100" y="250" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0sb7gg4_di" bpmnElement="Flow_0sb7gg4">
        <di:waypoint x="3020" y="512" />
        <di:waypoint x="3060" y="512" />
        <di:waypoint x="3060" y="460" />
        <di:waypoint x="3100" y="460" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0apv3zj_di" bpmnElement="Flow_0apv3zj">
        <di:waypoint x="3020" y="410" />
        <di:waypoint x="3060" y="410" />
        <di:waypoint x="3060" y="460" />
        <di:waypoint x="3100" y="460" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_024pt2d_di" bpmnElement="Flow_024pt2d">
        <di:waypoint x="3200" y="460" />
        <di:waypoint x="3225" y="460" />
        <di:waypoint x="3225" y="350" />
        <di:waypoint x="3250" y="350" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_070y5j7_di" bpmnElement="Flow_070y5j7">
        <di:waypoint x="3200" y="250" />
        <di:waypoint x="3225" y="250" />
        <di:waypoint x="3225" y="350" />
        <di:waypoint x="3250" y="350" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0o16oaf_di" bpmnElement="Flow_0o16oaf">
        <di:waypoint x="3350" y="350" />
        <di:waypoint x="3390" y="350" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1fxfnaa_di" bpmnElement="Flow_1fxfnaa">
        <di:waypoint x="3490" y="350" />
        <di:waypoint x="3532" y="350" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1ctyssr_di" bpmnElement="Flow_1ctyssr">
        <di:waypoint x="2206" y="350" />
        <di:waypoint x="2260" y="350" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_18js6yr_di" bpmnElement="Flow_18js6yr">
        <di:waypoint x="2360" y="350" />
        <di:waypoint x="2420" y="350" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_06mh348_di" bpmnElement="Flow_06mh348">
        <di:waypoint x="2520" y="350" />
        <di:waypoint x="2560" y="350" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0k2piq9_di" bpmnElement="Flow_0k2piq9">
        <di:waypoint x="2660" y="350" />
        <di:waypoint x="2705" y="350" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="Gateway_1w23zc6_di" bpmnElement="Gateway_1w23zc6" isMarkerVisible="true">
        <dc:Bounds x="3785" y="405" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_0nh9rj8" bpmnElement="Activity_1cxizrl">
        <dc:Bounds x="1520" y="510" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_10k0qjp" bpmnElement="Activity_15tbnk7" isExpanded="true">
        <dc:Bounds x="1350" y="1040" width="1280" height="200" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1lggnzi" bpmnElement="Event_0lgmd6v">
        <dc:Bounds x="1390" y="1122" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_10eos1i" bpmnElement="Activity_1c5cpsh">
        <dc:Bounds x="1470" y="1100" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_19gjff0" bpmnElement="Activity_0x6px15">
        <dc:Bounds x="1640" y="1100" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_0t2849e" bpmnElement="Activity_13ng4pl">
        <dc:Bounds x="2370" y="1100" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_170zdwu" bpmnElement="Event_1mynaur">
        <dc:Bounds x="2542" y="1122" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_createCase_di" bpmnElement="Activity_1ond2rr">
        <dc:Bounds x="1790" y="1100" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_saveCase_di" bpmnElement="Activity_saveCase">
        <dc:Bounds x="1940" y="1100" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_caseRelations_di" bpmnElement="Activity_caseRelations">
        <dc:Bounds x="2080" y="1100" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_saveCaseRelations_di" bpmnElement="Activity_saveCaseRelations">
        <dc:Bounds x="2220" y="1100" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="BPMNEdge_11s4lwa" bpmnElement="Flow_1a2s3om">
        <di:waypoint x="1426" y="1140" />
        <di:waypoint x="1470" y="1140" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_1vgrn9b" bpmnElement="Flow_0wjmsrz">
        <di:waypoint x="1570" y="1140" />
        <di:waypoint x="1640" y="1140" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_05nrs2k" bpmnElement="Flow_1poj9km">
        <di:waypoint x="2470" y="1140" />
        <di:waypoint x="2542" y="1140" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0ylrugl_di" bpmnElement="Flow_0ylrugl">
        <di:waypoint x="1740" y="1140" />
        <di:waypoint x="1790" y="1140" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1mc1fcl_di" bpmnElement="Flow_1mc1fcl">
        <di:waypoint x="1890" y="1140" />
        <di:waypoint x="1940" y="1140" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1oqwvec_di" bpmnElement="Flow_1oqwvec">
        <di:waypoint x="2040" y="1140" />
        <di:waypoint x="2080" y="1140" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1u09zhl_di" bpmnElement="Flow_1u09zhl">
        <di:waypoint x="2180" y="1140" />
        <di:waypoint x="2220" y="1140" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1r6vyt1_di" bpmnElement="Flow_1r6vyt1">
        <di:waypoint x="2320" y="1140" />
        <di:waypoint x="2370" y="1140" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="Event_059luvt_di" bpmnElement="Event_059luvt">
        <dc:Bounds x="2712" y="1232" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0lqkyzb_di" bpmnElement="Activity_0lqkyzb">
        <dc:Bounds x="2680" y="1100" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_1jji15u_di" bpmnElement="Event_1jji15u">
        <dc:Bounds x="3812" y="162" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_1lyf2j0_di" bpmnElement="Gateway_1lyf2j0" isMarkerVisible="true">
        <dc:Bounds x="3685" y="405" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1qhqh1c_di" bpmnElement="Activity_1qhqh1c" isExpanded="true">
        <dc:Bounds x="2060" y="1360" width="830" height="200" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_08vq00w_di" bpmnElement="Event_08vq00w">
        <dc:Bounds x="2100" y="1442" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1h51yqk_di" bpmnElement="Activity_1sz0i2r">
        <dc:Bounds x="2180" y="1420" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_15hckls_di" bpmnElement="Activity_15hckls">
        <dc:Bounds x="2350" y="1420" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_06urcbs_di" bpmnElement="Activity_06urcbs">
        <dc:Bounds x="2500" y="1420" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0i0fdee_di" bpmnElement="Activity_createCase">
        <dc:Bounds x="2660" y="1420" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_1nr78u6_di" bpmnElement="Event_1nr78u6">
        <dc:Bounds x="2822" y="1442" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_06fmxl5_di" bpmnElement="Flow_06fmxl5">
        <di:waypoint x="2136" y="1460" />
        <di:waypoint x="2180" y="1460" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1ar0vf8_di" bpmnElement="Flow_1ar0vf8">
        <di:waypoint x="2280" y="1460" />
        <di:waypoint x="2350" y="1460" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0ob5szp_di" bpmnElement="Flow_0ob5szp">
        <di:waypoint x="2450" y="1460" />
        <di:waypoint x="2500" y="1460" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1tccoe5_di" bpmnElement="Flow_1tccoe5">
        <di:waypoint x="2600" y="1460" />
        <di:waypoint x="2660" y="1460" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1g2ppru_di" bpmnElement="Flow_1g2ppru">
        <di:waypoint x="2760" y="1460" />
        <di:waypoint x="2822" y="1460" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="BPMNShape_02gum8s" bpmnElement="Activity_0rct1ii" isExpanded="true">
        <dc:Bounds x="4020" y="850" width="1280" height="200" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1t1ath8" bpmnElement="Event_00qdhwo">
        <dc:Bounds x="4060" y="932" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_0r2w05t" bpmnElement="Activity_1ngmirm">
        <dc:Bounds x="4140" y="910" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_0cysqv7" bpmnElement="Activity_0m6ekyc">
        <dc:Bounds x="4310" y="910" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_0td9l1f" bpmnElement="Activity_1ks6abo">
        <dc:Bounds x="5040" y="910" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1iwbrvw" bpmnElement="Event_0ov83yh">
        <dc:Bounds x="5212" y="932" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_0yl6vlb" bpmnElement="Activity_12ivexd">
        <dc:Bounds x="4460" y="910" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1hs94tu" bpmnElement="Activity_0sk21b5">
        <dc:Bounds x="4610" y="910" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_06s6g43" bpmnElement="Activity_163c1vy">
        <dc:Bounds x="4750" y="910" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1m5b5zu" bpmnElement="Activity_1u4ct90">
        <dc:Bounds x="4890" y="910" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="BPMNEdge_0brh92b" bpmnElement="Flow_0nlms8r">
        <di:waypoint x="4096" y="950" />
        <di:waypoint x="4140" y="950" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_02pzd95" bpmnElement="Flow_0ppwlzc">
        <di:waypoint x="4240" y="950" />
        <di:waypoint x="4310" y="950" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_1cpi8wr" bpmnElement="Flow_1rkb2mj">
        <di:waypoint x="4410" y="950" />
        <di:waypoint x="4460" y="950" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_0hw3usy" bpmnElement="Flow_01r3qj1">
        <di:waypoint x="4990" y="950" />
        <di:waypoint x="5040" y="950" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_04xhiwk" bpmnElement="Flow_078srsa">
        <di:waypoint x="5140" y="950" />
        <di:waypoint x="5212" y="950" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_0ucl37i" bpmnElement="Flow_0dlhpaj">
        <di:waypoint x="4560" y="950" />
        <di:waypoint x="4610" y="950" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_0b5xh3o" bpmnElement="Flow_18mlxry">
        <di:waypoint x="4710" y="950" />
        <di:waypoint x="4750" y="950" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_1q5hco6" bpmnElement="Flow_1fvcxex">
        <di:waypoint x="4850" y="950" />
        <di:waypoint x="4890" y="950" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="BPMNShape_0ie2rdm" bpmnElement="Activity_0y4debj" isExpanded="true">
        <dc:Bounds x="3660" y="1290" width="1280" height="200" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_04la9zj" bpmnElement="Event_0iwxvi0">
        <dc:Bounds x="3700" y="1372" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1fl53ts" bpmnElement="Activity_0hdog1z">
        <dc:Bounds x="3780" y="1350" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1qkzyux" bpmnElement="Activity_1w9jji9">
        <dc:Bounds x="3950" y="1350" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1yjsgg1" bpmnElement="Activity_1h62s4l">
        <dc:Bounds x="4680" y="1350" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1ipipoi" bpmnElement="Event_0yrgdcs">
        <dc:Bounds x="4852" y="1372" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1fsinn9" bpmnElement="Activity_1j4ph0e">
        <dc:Bounds x="4100" y="1350" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_0o2e35c" bpmnElement="Activity_1wv2275">
        <dc:Bounds x="4250" y="1350" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_0zijef7" bpmnElement="Activity_0r0bs0s">
        <dc:Bounds x="4390" y="1350" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_0mahjj1" bpmnElement="Activity_110zu51">
        <dc:Bounds x="4530" y="1350" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="BPMNEdge_0fyi90y" bpmnElement="Flow_1msxxhj">
        <di:waypoint x="3736" y="1390" />
        <di:waypoint x="3780" y="1390" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_1e9ekj7" bpmnElement="Flow_0p574uz">
        <di:waypoint x="3880" y="1390" />
        <di:waypoint x="3950" y="1390" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_1fv55xi" bpmnElement="Flow_0skjlq0">
        <di:waypoint x="4050" y="1390" />
        <di:waypoint x="4100" y="1390" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_12au2o9" bpmnElement="Flow_11y6xut">
        <di:waypoint x="4630" y="1390" />
        <di:waypoint x="4680" y="1390" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_0nwa4rk" bpmnElement="Flow_0qwlgtm">
        <di:waypoint x="4780" y="1390" />
        <di:waypoint x="4852" y="1390" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_09vbcko" bpmnElement="Flow_0ewrgb0">
        <di:waypoint x="4200" y="1390" />
        <di:waypoint x="4250" y="1390" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_04t1ho3" bpmnElement="Flow_0fsg058">
        <di:waypoint x="4350" y="1390" />
        <di:waypoint x="4390" y="1390" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_0hugk0q" bpmnElement="Flow_0k03hzr">
        <di:waypoint x="4490" y="1390" />
        <di:waypoint x="4530" y="1390" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="BPMNShape_00wuzhm" bpmnElement="Activity_0zf4qnr" isExpanded="true">
        <dc:Bounds x="4110" y="450" width="1030" height="200" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_0b6e0zb" bpmnElement="Event_1n9iz26">
        <dc:Bounds x="4150" y="532" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1enelry" bpmnElement="Activity_0i4y7ua">
        <dc:Bounds x="4210" y="510" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_102kry8" bpmnElement="Activity_0a04a0j">
        <dc:Bounds x="4460" y="510" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1ojmgal" bpmnElement="Activity_01gaq8m">
        <dc:Bounds x="4340" y="510" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_17qupop" bpmnElement="Activity_0v8so4x">
        <dc:Bounds x="4580" y="510" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_0ddonj9" bpmnElement="Activity_18k3idl">
        <dc:Bounds x="4700" y="510" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_12rkogn" bpmnElement="Activity_0qkcfzr">
        <dc:Bounds x="4820" y="510" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1upo801" bpmnElement="Activity_105ohr9">
        <dc:Bounds x="4950" y="510" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_0qvy8yu" bpmnElement="Event_193dy07">
        <dc:Bounds x="5072" y="532" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="BPMNEdge_0vd5a2f" bpmnElement="Flow_0nfurhh">
        <di:waypoint x="4186" y="550" />
        <di:waypoint x="4210" y="550" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_1py2p7h" bpmnElement="Flow_1ug0udl">
        <di:waypoint x="4310" y="550" />
        <di:waypoint x="4340" y="550" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_03mbuba" bpmnElement="Flow_1x04pd3">
        <di:waypoint x="4440" y="550" />
        <di:waypoint x="4460" y="550" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_1l9rjsg" bpmnElement="Flow_0msxmtm">
        <di:waypoint x="4560" y="550" />
        <di:waypoint x="4580" y="550" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_1selzd0" bpmnElement="Flow_132eatj">
        <di:waypoint x="4680" y="550" />
        <di:waypoint x="4700" y="550" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_1btqi2w" bpmnElement="Flow_0llw01f">
        <di:waypoint x="4800" y="550" />
        <di:waypoint x="4820" y="550" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_09x909s" bpmnElement="Flow_1awns9y">
        <di:waypoint x="4920" y="550" />
        <di:waypoint x="4950" y="550" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_0f1vlc5" bpmnElement="Flow_0s9va49">
        <di:waypoint x="5050" y="550" />
        <di:waypoint x="5072" y="550" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="Activity_0y09n4q_di" bpmnElement="Activity_0y09n4q" isExpanded="true">
        <dc:Bounds x="4115" y="130" width="1025" height="200" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_1gakj31_di" bpmnElement="Event_1gakj31">
        <dc:Bounds x="4155" y="212" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0a602fs_di" bpmnElement="Activity_0q1u7ac">
        <dc:Bounds x="4215" y="190" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_05iap0j_di" bpmnElement="Activity_1c009cx">
        <dc:Bounds x="4465" y="190" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1d0pkbr_di" bpmnElement="Activity_1d0pkbr">
        <dc:Bounds x="4345" y="190" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_00iazqm_di" bpmnElement="Activity_00iazqm">
        <dc:Bounds x="4590" y="190" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0f8j3v5_di" bpmnElement="Activity_1y52sob">
        <dc:Bounds x="4710" y="190" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_01jw7yf_di" bpmnElement="Activity_01jw7yf">
        <dc:Bounds x="4840" y="190" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_18uh03o_di" bpmnElement="Activity_18uh03o">
        <dc:Bounds x="4960" y="190" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_1t45a4a_di" bpmnElement="Event_1t45a4a">
        <dc:Bounds x="5082" y="212" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_1ufm3zu_di" bpmnElement="Flow_1ufm3zu">
        <di:waypoint x="4191" y="230" />
        <di:waypoint x="4215" y="230" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0o8qg6a_di" bpmnElement="Flow_0o8qg6a">
        <di:waypoint x="4315" y="230" />
        <di:waypoint x="4345" y="230" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1gnbiyl_di" bpmnElement="Flow_1gnbiyl">
        <di:waypoint x="4445" y="230" />
        <di:waypoint x="4465" y="230" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0qbk3gz_di" bpmnElement="Flow_0qbk3gz">
        <di:waypoint x="4565" y="230" />
        <di:waypoint x="4590" y="230" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0kfq50q_di" bpmnElement="Flow_0kfq50q">
        <di:waypoint x="4690" y="230" />
        <di:waypoint x="4710" y="230" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1p9npa3_di" bpmnElement="Flow_1p9npa3">
        <di:waypoint x="4810" y="230" />
        <di:waypoint x="4840" y="230" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1i4u616_di" bpmnElement="Flow_1i4u616">
        <di:waypoint x="4940" y="230" />
        <di:waypoint x="4960" y="230" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_14kdyzj_di" bpmnElement="Flow_14kdyzj">
        <di:waypoint x="5060" y="230" />
        <di:waypoint x="5082" y="230" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1sbvndj_di" bpmnElement="Flow_1sbvndj">
        <di:waypoint x="1346" y="414" />
        <di:waypoint x="1390" y="414" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0aknsys_di" bpmnElement="Flow_0aknsys">
        <di:waypoint x="1595" y="414" />
        <di:waypoint x="1650" y="414" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0vh55hu_di" bpmnElement="Flow_0vh55hu">
        <di:waypoint x="1490" y="414" />
        <di:waypoint x="1545" y="414" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0lrcrgx_di" bpmnElement="Flow_0lrcrgx">
        <di:waypoint x="1570" y="439" />
        <di:waypoint x="1570" y="510" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_18adh9k_di" bpmnElement="Flow_18adh9k">
        <di:waypoint x="1750" y="414" />
        <di:waypoint x="1800" y="414" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1drdweu_di" bpmnElement="Flow_1drdweu">
        <di:waypoint x="1900" y="414" />
        <di:waypoint x="1950" y="414" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0cqpgsw_di" bpmnElement="Flow_0cqpgsw">
        <di:waypoint x="2050" y="414" />
        <di:waypoint x="2130" y="414" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1k9y2g5_di" bpmnElement="Flow_1k9y2g5">
        <di:waypoint x="3835" y="430" />
        <di:waypoint x="3905" y="430" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0udljpz_di" bpmnElement="Flow_0udljpz">
        <di:waypoint x="1570" y="590" />
        <di:waypoint x="1570" y="702" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1ygeyrt_di" bpmnElement="Flow_1ygeyrt">
        <di:waypoint x="3810" y="455" />
        <di:waypoint x="3810" y="675" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0sq65hq_di" bpmnElement="Flow_0sq65hq">
        <di:waypoint x="2888" y="725" />
        <di:waypoint x="2888" y="1364" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2888" y="1042" width="32" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0j54stc_di" bpmnElement="Flow_0j54stc">
        <di:waypoint x="2863" y="700" />
        <di:waypoint x="1990" y="700" />
        <di:waypoint x="1990" y="1040" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2757" y="752" width="32" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_08af9ro_di" bpmnElement="Flow_08af9ro">
        <di:waypoint x="2630" y="1140" />
        <di:waypoint x="2680" y="1140" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1nor7bf_di" bpmnElement="Flow_1nor7bf">
        <di:waypoint x="2730" y="1180" />
        <di:waypoint x="2730" y="1232" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0t32iji_di" bpmnElement="Flow_0t32iji">
        <di:waypoint x="3710" y="405" />
        <di:waypoint x="3710" y="180" />
        <di:waypoint x="3812" y="180" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0ij3i33_di" bpmnElement="Flow_0ij3i33">
        <di:waypoint x="3735" y="430" />
        <di:waypoint x="3785" y="430" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_18wv7q1_di" bpmnElement="Flow_18wv7q1">
        <di:waypoint x="3600" y="430" />
        <di:waypoint x="3685" y="430" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1o50puf_di" bpmnElement="Flow_1o50puf">
        <di:waypoint x="2890" y="1460" />
        <di:waypoint x="2990" y="1460" />
        <di:waypoint x="2990" y="1562" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0fxo5b6_di" bpmnElement="Flow_0fxo5b6">
        <di:waypoint x="5300" y="950" />
        <di:waypoint x="5350" y="950" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0bwij5y_di" bpmnElement="Flow_0bwij5y">
        <di:waypoint x="5400" y="990" />
        <di:waypoint x="5400" y="1052" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_047uvnt" bpmnElement="Flow_091qt4p">
        <di:waypoint x="4940" y="1390" />
        <di:waypoint x="4990" y="1390" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_0prgvuz" bpmnElement="Flow_1kun2p7">
        <di:waypoint x="5040" y="1430" />
        <di:waypoint x="5040" y="1492" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1kuw6vx_di" bpmnElement="Flow_1kuw6vx">
        <di:waypoint x="3930" y="725" />
        <di:waypoint x="3930" y="1290" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_14dycvc_di" bpmnElement="Flow_14dycvc">
        <di:waypoint x="3955" y="700" />
        <di:waypoint x="4720" y="700" />
        <di:waypoint x="4720" y="850" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="4319" y="682" width="38" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1y3pmfd_di" bpmnElement="Flow_1y3pmfd">
        <di:waypoint x="3785" y="700" />
        <di:waypoint x="2913" y="700" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_03novcb_di" bpmnElement="Flow_03novcb">
        <di:waypoint x="3835" y="700" />
        <di:waypoint x="3905" y="700" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="3851" y="682" width="41" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_10oe2bb" bpmnElement="Flow_02rswm3">
        <di:waypoint x="5140" y="554" />
        <di:waypoint x="5170" y="554" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_1e4vhd5" bpmnElement="Flow_05e6hx0">
        <di:waypoint x="5270" y="554" />
        <di:waypoint x="5300" y="554" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_01r3519" bpmnElement="Flow_13tlp5a">
        <di:waypoint x="5400" y="554" />
        <di:waypoint x="5432" y="554" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1xc0rm5_di" bpmnElement="Flow_1xc0rm5">
        <di:waypoint x="5140" y="234" />
        <di:waypoint x="5170" y="234" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_12kd06o_di" bpmnElement="Flow_12kd06o">
        <di:waypoint x="5270" y="234" />
        <di:waypoint x="5290" y="234" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1x1l9mb_di" bpmnElement="Flow_1x1l9mb">
        <di:waypoint x="5390" y="234" />
        <di:waypoint x="5432" y="234" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0nowm6h_di" bpmnElement="Flow_0nowm6h">
        <di:waypoint x="3955" y="430" />
        <di:waypoint x="4035" y="430" />
        <di:waypoint x="4035" y="230" />
        <di:waypoint x="4115" y="230" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1kone15_di" bpmnElement="Flow_1kone15">
        <di:waypoint x="3930" y="455" />
        <di:waypoint x="3930" y="550" />
        <di:waypoint x="4110" y="550" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="3965" y="500" width="41" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="Event_1javps5_di" bpmnElement="Event_1javps5">
        <dc:Bounds x="5852" y="722" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="TextAnnotation_049rt3r_di" bpmnElement="TextAnnotation_049rt3r">
        <dc:Bounds x="160" y="420" width="323" height="125" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="TextAnnotation_0ho7fj0_di" bpmnElement="TextAnnotation_0ho7fj0">
        <dc:Bounds x="470" y="470" width="100" height="30" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_0ijxlkz_di" bpmnElement="Flow_0ijxlkz">
        <di:waypoint x="470" y="590" />
        <di:waypoint x="520" y="590" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0hlfsn7_di" bpmnElement="Flow_0hlfsn7">
        <di:waypoint x="340" y="590" />
        <di:waypoint x="370" y="590" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0gavm8x_di" bpmnElement="Flow_0gavm8x">
        <di:waypoint x="790" y="590" />
        <di:waypoint x="990" y="590" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0o3k3mr_di" bpmnElement="Flow_0o3k3mr">
        <di:waypoint x="620" y="590" />
        <di:waypoint x="690" y="590" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_10kplv5_di" bpmnElement="Flow_10kplv5">
        <di:waypoint x="1090" y="590" />
        <di:waypoint x="1270" y="590" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0kf9713_di" bpmnElement="Flow_0kf9713">
        <di:waypoint x="5500" y="740" />
        <di:waypoint x="5852" y="740" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Association_0fu882p_di" bpmnElement="Association_0fu882p">
        <di:waypoint x="322" y="545" />
        <di:waypoint x="322" y="572" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Association_10u5pyr_di" bpmnElement="Association_10u5pyr">
        <di:waypoint x="458" y="550" />
        <di:waypoint x="506" y="500" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
