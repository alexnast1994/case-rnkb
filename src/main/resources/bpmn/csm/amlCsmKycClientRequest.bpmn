<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:modeler="http://camunda.org/schema/modeler/1.0" id="Definitions_1eoxw1v" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="5.0.0" modeler:executionPlatform="Camunda Platform" modeler:executionPlatformVersion="7.15.0">
  <bpmn:process id="amlCsmKycClientRequest" name="19. Сохранение результатов Онлайн/Офлайн от поисковой машины по клиентам" isExecutable="true">
    <bpmn:startEvent id="Event_0bpxwwc">
      <bpmn:outgoing>Flow_1crfnfk</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:serviceTask id="Activity_0fehiu4" name="Process Logging" camunda:delegateExpression="${loggerDelegate}">
      <bpmn:incoming>Flow_1crfnfk</bpmn:incoming>
      <bpmn:outgoing>Flow_05quuqa</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:serviceTask id="Activity_0p5b1rm" name="Open Session" camunda:delegateExpression="${openSessionDelegate}">
      <bpmn:incoming>Flow_05quuqa</bpmn:incoming>
      <bpmn:outgoing>Flow_15jyl5l</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:serviceTask id="Activity_0uuh0i5" name="Start Transaction Delegate" camunda:delegateExpression="${startTransactionDelegate}">
      <bpmn:incoming>Flow_15jyl5l</bpmn:incoming>
      <bpmn:outgoing>Flow_0v9yh38</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:sequenceFlow id="Flow_1crfnfk" sourceRef="Event_0bpxwwc" targetRef="Activity_0fehiu4" />
    <bpmn:sequenceFlow id="Flow_05quuqa" sourceRef="Activity_0fehiu4" targetRef="Activity_0p5b1rm" />
    <bpmn:sequenceFlow id="Flow_15jyl5l" sourceRef="Activity_0p5b1rm" targetRef="Activity_0uuh0i5" />
    <bpmn:subProcess id="Activity_1mw9f6o">
      <bpmn:incoming>Flow_0v9yh38</bpmn:incoming>
      <bpmn:outgoing>Flow_03gukxj</bpmn:outgoing>
      <bpmn:startEvent id="Event_01z62wt">
        <bpmn:outgoing>Flow_0nm40x4</bpmn:outgoing>
      </bpmn:startEvent>
      <bpmn:scriptTask id="Activity_0ldya20" name="Payload Retirieving" scriptFormat="groovy">
        <bpmn:incoming>Flow_0nm40x4</bpmn:incoming>
        <bpmn:outgoing>Flow_0hb06iv</bpmn:outgoing>
        <bpmn:script>import static org.camunda.spin.Spin.*
import static org.camunda.spin.DataFormats.*

def jsonStr = execution.getVariable("payload")
def jsonData = JSON(jsonStr)

def clients = jsonData.prop("Clients")
if(clients.elements().size() &gt; 0) {
    execution.setVariable("clientItems", clients)
} else {
    throw new RuntimeException("Invalid Clients")
}

def clientCheckResults = jsonData.prop("ResponseData").prop("ClientCheckResult")
if (clientCheckResults.elements().size() &gt; 0) {
    execution.setVariable("clientCheckResultItems", clientCheckResults)
} else {
    throw new RuntimeException("Invalid ClientCheckResult")
}</bpmn:script>
      </bpmn:scriptTask>
      <bpmn:sequenceFlow id="Flow_0nm40x4" sourceRef="Event_01z62wt" targetRef="Activity_0ldya20" />
      <bpmn:subProcess id="Activity_Clients_Handling" name="Clients Handling">
        <bpmn:incoming>Flow_0hb06iv</bpmn:incoming>
        <bpmn:outgoing>Flow_0m9d8o5</bpmn:outgoing>
        <bpmn:multiInstanceLoopCharacteristics isSequential="true" camunda:collection="${clientItems.elements()}" camunda:elementVariable="clientItem" />
        <bpmn:startEvent id="Event_1xfcm0n">
          <bpmn:outgoing>Flow_0u6jn9h</bpmn:outgoing>
        </bpmn:startEvent>
        <bpmn:scriptTask id="Activity_0pnz9cm" name="Client Check Result Retrieving" scriptFormat="groovy">
          <bpmn:incoming>Flow_0u6jn9h</bpmn:incoming>
          <bpmn:outgoing>Flow_0k0u987</bpmn:outgoing>
          <bpmn:script>import static org.camunda.spin.Spin.*
import static org.camunda.spin.DataFormats.*

def clientCheckResultItems = execution.getVariable("clientCheckResultItems")
def clientItem = execution.getVariable("clientItem")
def targetSourceId = clientItem.prop("SourceId").stringValue()
def clientCheckResult = JSON("{}")

clientCheckResultItems.elements().each{item -&gt; 
    def sourceId = item.prop("SourceId").stringValue()
    if (sourceId == targetSourceId) {
        clientCheckResult = item
    }
}

execution.setVariable("clientCheckResult", clientCheckResult)
execution.setVariable("clientId", targetSourceId)</bpmn:script>
        </bpmn:scriptTask>
        <bpmn:sequenceFlow id="Flow_0u6jn9h" sourceRef="Event_1xfcm0n" targetRef="Activity_0pnz9cm" />
        <bpmn:subProcess id="Activity_10o7dqk" name="Result Handling">
          <bpmn:incoming>Flow_00656g0</bpmn:incoming>
          <bpmn:outgoing>Flow_0dk0obq</bpmn:outgoing>
          <bpmn:multiInstanceLoopCharacteristics isSequential="true" camunda:collection="${resultItems.elements()}" camunda:elementVariable="resultItem" />
          <bpmn:startEvent id="Event_118qtrk">
            <bpmn:outgoing>Flow_0rdzslu</bpmn:outgoing>
          </bpmn:startEvent>
          <bpmn:scriptTask id="Activity_0uzj693" name="Payload Retirieving" scriptFormat="groovy">
            <bpmn:incoming>Flow_0rdzslu</bpmn:incoming>
            <bpmn:outgoing>Flow_1897it8</bpmn:outgoing>
            <bpmn:script>import static org.camunda.spin.Spin.*
import static org.camunda.spin.DataFormats.*

def clientItem = execution.getVariable("clientItem")
def resultItem = execution.getVariable("resultItem")
def clientCheckResult = execution.getVariable("clientCheckResult")

def record = resultItem.prop("record")
def exId = record.prop("exId")?.stringValue()
def num = record.prop("num")?.stringValue()
def typeList = []

clientCheckResult.prop("KYCList")?.elements()?.each{kyc -&gt;
    def type = kyc.prop("Id")?.stringValue()
    if (type != null) {
        typeList.add(type)
    }
}

execution.setVariable("typeList", typeList)
execution.setVariable("exId", exId)
execution.setVariable("num", num)</bpmn:script>
          </bpmn:scriptTask>
          <bpmn:scriptTask id="Activity_15sew4o" name="Case Status Decision" scriptFormat="groovy">
            <bpmn:incoming>Flow_1897it8</bpmn:incoming>
            <bpmn:outgoing>Flow_1vua5pp</bpmn:outgoing>
            <bpmn:script>import static org.camunda.spin.Spin.*
import static org.camunda.spin.DataFormats.*

def exId = execution.getVariable("exId")
def num = execution.getVariable("num")
def typeList = execution.getVariable("typeList")
def clientId = execution.getVariable("client")?.getId()
def caseItems = caseRepo.getLatestCaseByClientIdAndExIdAndNumAndTypeList(clientId, typeList, exId, num)
def status

if (caseItems.size() &gt; 0) {
    def caseItem = caseItems.get(0)
    status = caseItem.getStatus()?.getCode()
    execution.setVariable("caseItem", caseItem)
}

def processName = execution.getVariable("processName")
def csd = 0

if ((status == "1" &amp;&amp; processName == "clientProcess") || (status == "2" &amp;&amp; processName == "offlineCreateCase")) {
    csd = 1
} else if (status == "3" || status == "4") {
    csd = 2
} else if (status == "5") {
    csd = 3
}

execution.setVariable("csd", csd)</bpmn:script>
          </bpmn:scriptTask>
          <bpmn:exclusiveGateway id="Gateway_0uxnypy">
            <bpmn:incoming>Flow_1vua5pp</bpmn:incoming>
            <bpmn:outgoing>Flow_0sn2zax</bpmn:outgoing>
            <bpmn:outgoing>Flow_00mgcwc</bpmn:outgoing>
            <bpmn:outgoing>Flow_1vgkfgw</bpmn:outgoing>
          </bpmn:exclusiveGateway>
          <bpmn:scriptTask id="Activity_15cx39w" name="Change Case Status" scriptFormat="groovy">
            <bpmn:incoming>Flow_0sn2zax</bpmn:incoming>
            <bpmn:outgoing>Flow_05f27h4</bpmn:outgoing>
            <bpmn:script>import static org.camunda.spin.Spin.*
import static org.camunda.spin.DataFormats.*
import com.prime.db.rnkb.model.BaseDictionary

BaseDictionary getBd(Integer type, String code) {
   baseDictRepo.getByBaseDictionaryTypeCodeAndCode(type, code);
}

def status3 = getBd(286, "3")
def cs = execution.getVariable("caseItem")

cs.status = status3
execution.setVariable("case", cs)

</bpmn:script>
          </bpmn:scriptTask>
          <bpmn:serviceTask id="Activity_1js50xw" name="Save Case Status" camunda:delegateExpression="${saveObjectDelegate}">
            <bpmn:extensionElements>
              <camunda:inputOutput>
                <camunda:inputParameter name="saveObject">${case}</camunda:inputParameter>
              </camunda:inputOutput>
            </bpmn:extensionElements>
            <bpmn:incoming>Flow_05f27h4</bpmn:incoming>
            <bpmn:outgoing>Flow_1yqdt8n</bpmn:outgoing>
          </bpmn:serviceTask>
          <bpmn:endEvent id="Event_09g1ver">
            <bpmn:incoming>Flow_00mgcwc</bpmn:incoming>
          </bpmn:endEvent>
          <bpmn:sequenceFlow id="Flow_0sn2zax" name="CSD #1" sourceRef="Gateway_0uxnypy" targetRef="Activity_15cx39w">
            <bpmn:documentation>CSD - Case Status Decision - Решение по статусу найденного кейса (или ненайденного)
1 - Меняем статус найденного кейса и создаем новый
2 - Завершаем процесс
3 - Создаем новый кейс</bpmn:documentation>
            <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${csd == 1}</bpmn:conditionExpression>
          </bpmn:sequenceFlow>
          <bpmn:sequenceFlow id="Flow_00mgcwc" name="CSD #2" sourceRef="Gateway_0uxnypy" targetRef="Event_09g1ver">
            <bpmn:documentation>CSD - Case Status Decision - Решение по статусу найденного кейса (или ненайденного)
1 - Меняем статус найденного кейса и создаем новый
2 - Завершаем процесс
3 - Создаем новый кейс</bpmn:documentation>
            <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${csd == 2}</bpmn:conditionExpression>
          </bpmn:sequenceFlow>
          <bpmn:sequenceFlow id="Flow_05f27h4" sourceRef="Activity_15cx39w" targetRef="Activity_1js50xw" />
          <bpmn:sequenceFlow id="Flow_1vua5pp" sourceRef="Activity_15sew4o" targetRef="Gateway_0uxnypy" />
          <bpmn:subProcess id="Activity_02vg82q" name="Case Creation">
            <bpmn:incoming>Flow_1yqdt8n</bpmn:incoming>
            <bpmn:incoming>Flow_1vgkfgw</bpmn:incoming>
            <bpmn:outgoing>Flow_08yq38b</bpmn:outgoing>
            <bpmn:startEvent id="Event_09o8qzt">
              <bpmn:outgoing>Flow_18xp7a5</bpmn:outgoing>
            </bpmn:startEvent>
            <bpmn:scriptTask id="Activity_1cp5fv0" name="Case Filling" scriptFormat="groovy">
              <bpmn:incoming>Flow_18xp7a5</bpmn:incoming>
              <bpmn:outgoing>Flow_0xqw8f0</bpmn:outgoing>
              <bpmn:script>import static org.camunda.spin.Spin.*
import static org.camunda.spin.DataFormats.*
import com.prime.db.rnkb.model.Case
import com.prime.db.rnkb.model.BaseDictionary
import java.time.LocalDateTime

BaseDictionary getBd(Integer type, String code) {
    baseDictRepo.getByBaseDictionaryTypeCodeAndCode(type, code);
}

def processName = execution.getVariable("processName")
def csd = execution.getVariable("csd")
def status

if (csd == null &amp;&amp; processName == "clientProcess") {
    status = getBd(286, "1")
} else if (csd == null &amp;&amp; processName == "offlineCreateCase") {
    status = getBd(286, "2")
} else if (csd == 1) {
    status = getBd(286, "3")
} else if (csd == 3) {
    status = getBd(286, "5")
} else {
    throw new RuntimeException("Case status cannot be calculated")
}


def cs = new Case()
cs.caseType = getBd(18, "5")
cs.status = status
cs.creationdate = LocalDateTime.now()

execution.setVariable("caseItem", cs)</bpmn:script>
            </bpmn:scriptTask>
            <bpmn:serviceTask id="Activity_Case_Saving" name="Case Saving" camunda:delegateExpression="${saveObjectDelegate}">
              <bpmn:extensionElements>
                <camunda:inputOutput>
                  <camunda:inputParameter name="saveObject">${caseItem}</camunda:inputParameter>
                  <camunda:inputParameter name="outputVarName">caseItem</camunda:inputParameter>
                </camunda:inputOutput>
              </bpmn:extensionElements>
              <bpmn:incoming>Flow_0xqw8f0</bpmn:incoming>
              <bpmn:outgoing>Flow_0vgu2xc</bpmn:outgoing>
            </bpmn:serviceTask>
            <bpmn:endEvent id="Event_0m0mboy">
              <bpmn:incoming>Flow_0vgu2xc</bpmn:incoming>
            </bpmn:endEvent>
            <bpmn:sequenceFlow id="Flow_0vgu2xc" sourceRef="Activity_Case_Saving" targetRef="Event_0m0mboy" />
            <bpmn:sequenceFlow id="Flow_0xqw8f0" sourceRef="Activity_1cp5fv0" targetRef="Activity_Case_Saving" />
            <bpmn:sequenceFlow id="Flow_18xp7a5" sourceRef="Event_09o8qzt" targetRef="Activity_1cp5fv0" />
          </bpmn:subProcess>
          <bpmn:sequenceFlow id="Flow_1yqdt8n" sourceRef="Activity_1js50xw" targetRef="Activity_02vg82q" />
          <bpmn:sequenceFlow id="Flow_1vgkfgw" name="CSD #3" sourceRef="Gateway_0uxnypy" targetRef="Activity_02vg82q" />
          <bpmn:subProcess id="Activity_1v5jznt" name="Kyc Case Client Lists">
            <bpmn:incoming>Flow_08yq38b</bpmn:incoming>
            <bpmn:outgoing>Flow_15ogu7q</bpmn:outgoing>
            <bpmn:startEvent id="Event_1pfart9">
              <bpmn:outgoing>Flow_0leqngs</bpmn:outgoing>
            </bpmn:startEvent>
            <bpmn:scriptTask id="Activity_00si6fi" name="List1 Filling" scriptFormat="groovy">
              <bpmn:incoming>Flow_0leqngs</bpmn:incoming>
              <bpmn:outgoing>Flow_19djyrd</bpmn:outgoing>
              <bpmn:script>import static org.camunda.spin.Spin.*
import static org.camunda.spin.DataFormats.*
import com.prime.db.rnkb.model.kyc.KycCaseClientList1

def cs = execution.getVariable("caseItem")
def client = execution.getVariable("client")

def list1 = new KycCaseClientList1()
list1.caseId = cs
list1.clientId = client

execution.setVariable("list1Item", list1)</bpmn:script>
            </bpmn:scriptTask>
            <bpmn:scriptTask id="Activity_06v13eb" name="Name List Filling" scriptFormat="groovy">
              <bpmn:incoming>Flow_0crol6n</bpmn:incoming>
              <bpmn:outgoing>Flow_0eetssk</bpmn:outgoing>
              <bpmn:script>import static org.camunda.spin.Spin.*
import static org.camunda.spin.DataFormats.*
import com.prime.db.rnkb.model.kyc.KycCaseClientNameList;
import com.prime.db.rnkb.model.BaseDictionary

BaseDictionary getBd(Integer type, String code) {
    baseDictRepo.getByBaseDictionaryTypeCodeAndCode(type, code);
}

def resultItem = execution.getVariable("resultItem")
def list2Item = execution.getVariable("list2Item")


def names = resultItem.prop("record")?.prop("nameList")?.elements()

def bestMatch = resultItem.prop("bestMatch")?.prop("name")?.stringValue()
def bestMatchType = resultItem.prop("bestMatch")?.prop("nameType")?.stringValue()

def saveObjects = []

names?.each{name -&gt;
    def nameType = name.prop("nameType").stringValue()

    def nameList = new KycCaseClientNameList()
    nameList.kycCaseClientList2Id = list2Item
    nameList.nameType = getBd(280, nameType)
    nameList.name = name.prop("name").stringValue();

    if (name.hasProp("firstName")) {
        nameList.firstName = name.prop("firstName").stringValue()
    }

    if (name.hasProp("lastName")) {
        nameList.lastName = name.prop("lastName").stringValue()
    }

    if (name.hasProp("middleName")) {
        nameList.middleName = name.prop("middleName").stringValue()
    }

    if (name.hasProp("Latin")) {
        nameList.latin = name.prop("Latin").stringValue()
    }

    if (name.hasProp("DateOfBirth")) {
        nameList.dateOfBirth = name.prop("DateOfBirth").stringValue()
    }

    if (name.hasProp("YearOfBirth")) {
        nameList.yearOfBirth = name.prop("YearOfBirth").stringValue()
    }

    if (name.hasProp("PlaceOfBirth")) {
        nameList.placeOfBirth = name.prop("PlaceOfBirth").stringValue()
    }

    if (name.hasProp("INN")) {
        nameList.inn = name.prop("INN").stringValue()
    }

    if (name.hasProp("SNILS")) {
        nameList.snils = name.prop("SNILS").stringValue()
    }

    if (name.hasProp("RegistrationDate")) {
        nameList.registrationDate = name.prop("RegistrationDate").stringValue()
    }

    if (name.hasProp("PlaceOfRegistration")) {
        nameList.placeOfRegistration = name.prop("PlaceOfRegistration").stringValue()
    }

    if (name.hasProp("OGRN")) {
        nameList.ogrn = name.prop("OGRN").stringValue()
    }

    nameList.bestMatch = (nameList.name == bestMatch &amp;&amp; nameType == bestMatchType);

    saveObjects.add(nameList)
}

execution.setVariable("saveObjects", saveObjects);</bpmn:script>
            </bpmn:scriptTask>
            <bpmn:serviceTask id="Activity_List1_Saving" name="List1 Saving" camunda:delegateExpression="${saveObjectDelegate}">
              <bpmn:extensionElements>
                <camunda:inputOutput>
                  <camunda:inputParameter name="outputVarName">list1Item</camunda:inputParameter>
                  <camunda:inputParameter name="saveObject">${list1Item}</camunda:inputParameter>
                </camunda:inputOutput>
              </bpmn:extensionElements>
              <bpmn:incoming>Flow_19djyrd</bpmn:incoming>
              <bpmn:outgoing>Flow_0wwts1a</bpmn:outgoing>
            </bpmn:serviceTask>
            <bpmn:scriptTask id="Activity_1c5haxn" name="List2 Filling" scriptFormat="groovy">
              <bpmn:incoming>Flow_0wwts1a</bpmn:incoming>
              <bpmn:outgoing>Flow_1wdsir7</bpmn:outgoing>
              <bpmn:script>import static org.camunda.spin.Spin.*
import static org.camunda.spin.DataFormats.*
import com.prime.db.rnkb.model.kyc.KycCaseClientList2
import com.prime.db.rnkb.model.BaseDictionary
import org.camunda.spin.json.SpinJsonNode

BaseDictionary getBd(Integer type, String code) {
   baseDictRepo.getByBaseDictionaryTypeCodeAndCode(type, code);
}

String getMarkers(SpinJsonNode node, List&lt;String&gt; markers) {
    def result = []
    markers.each{m -&gt;
        if(m.startsWith("M")) {
            if(node.prop(m).isBoolean() &amp;&amp; node.prop(m).boolValue() == true)
                result.add(m)
        } else {
            if(node.prop(m)?.numberValue() != 0)
                result.add(m)
        }
    }

    return result.join(";")
}

def markers = ["M2", "M3", "M4", "M5", "M6", "M7", "M8", "M9", "M10", "M11", "M12", "M13", "M14", "M15", "M16", "M17","M18", "M19", "M20", "M21", "M22", "M23", "M24", "M25", "M26", "D27", "D28", "D29", "D0", "M28", "M29", "M30", "M31", "M32", "M33", "M34", "M35", "M36"]

def cs = execution.getVariable("caseItem")
def resultItem = execution.getVariable("resultItem")

def kycList = resultItem.prop("KYCList")
def typeList = kycList.prop("Id").stringValue()
def record = resultItem.prop("record")
def isActive = resultItem.prop("record").prop("isActive").boolValue()
def entityType = resultItem.prop("record").prop("entityType").stringValue()
def d0 = resultItem.prop("D0").numberValue()?.intValue()
def d27 = resultItem.prop("D27").numberValue()?.intValue()
def d28 = resultItem.prop("D28").numberValue()?.intValue()
def d29 = resultItem.prop("D29").numberValue()?.intValue()
// def levelBlocking = kycList.prop("LevelBlocking").numberValue()?.intValue()
// def checkStatus = kycList.prop("CheckStatus")?.numberValue()?.intValue()

def list2 = new KycCaseClientList2()
list2.caseId = cs
list2.typeList = getBd(214, typeList)
list2.exId = record.prop("exId").stringValue()
list2.num = record.prop("num").stringValue()
list2.markers = getMarkers(resultItem, markers)
list2.nameMatch = d0
list2.firstName = d27
list2.lastName = d28
list2.middleName = d29
//list2.levelBlocking = levelBlocking
//list2.checkStatus = checkStatus
list2.isActive = isActive
list2.entityType = entityType

execution.setVariable("list2Item", list2)</bpmn:script>
            </bpmn:scriptTask>
            <bpmn:serviceTask id="Activity_List2_Saving" name="List2 Saving" camunda:delegateExpression="${saveObjectDelegate}">
              <bpmn:extensionElements>
                <camunda:inputOutput>
                  <camunda:inputParameter name="outputVarName">list1Item</camunda:inputParameter>
                  <camunda:inputParameter name="saveObject">${list2Item}</camunda:inputParameter>
                </camunda:inputOutput>
              </bpmn:extensionElements>
              <bpmn:incoming>Flow_1wdsir7</bpmn:incoming>
              <bpmn:outgoing>Flow_0crol6n</bpmn:outgoing>
            </bpmn:serviceTask>
            <bpmn:serviceTask id="Activity_Save_Lists" name="Save Lists" camunda:delegateExpression="${saveObjectListDelegate}">
              <bpmn:extensionElements>
                <camunda:inputOutput>
                  <camunda:inputParameter name="saveObject">${saveObjects}</camunda:inputParameter>
                </camunda:inputOutput>
              </bpmn:extensionElements>
              <bpmn:incoming>Flow_1dvreq0</bpmn:incoming>
              <bpmn:incoming>Flow_0tnbmu6</bpmn:incoming>
              <bpmn:outgoing>Flow_0or65n9</bpmn:outgoing>
            </bpmn:serviceTask>
            <bpmn:scriptTask id="Activity_09mhvto" name="Versions List Filling" scriptFormat="groovy">
              <bpmn:incoming>Flow_1trwpwi</bpmn:incoming>
              <bpmn:outgoing>Flow_1dvreq0</bpmn:outgoing>
              <bpmn:outgoing>Flow_0tnbmu6</bpmn:outgoing>
              <bpmn:script>import static org.camunda.spin.Spin.*
import static org.camunda.spin.DataFormats.*
import com.prime.db.rnkb.model.kyc.KycCaseClientVersionsList;
import java.time.LocalDateTime
import java.time.format.DateTimeFormatter

import com.prime.db.rnkb.model.BaseDictionary

BaseDictionary getBd(Integer type, String code) {
    baseDictRepo.getByBaseDictionaryTypeCodeAndCode(type, code);
}

def resultItem = execution.getVariable("resultItem")
def list2Item = execution.getVariable("list2Item")
def saveObjects = execution.getVariable("saveObjects")

def versions = resultItem?.prop("record")?.prop("versionsList")?.elements()
def signOfTerrorist = 0

if (resultItem.prop("record").hasProp("signOfTerrorist")) {
    signOfTerrorist = resultItem.prop("record").prop("signOfTerrorist").numberValue().intValue()
}

DateTimeFormatter formatter = DateTimeFormatter.ofPattern("yyyy-MM-dd'T'HH:mm:ss.SSS");

versions?.each{version -&gt;
    def versionList = new KycCaseClientVersionsList()

    versionList.kycCaseClientList2Id = list2Item
    versionList.listIdentifier = version.prop("listIdentifier").stringValue()
    versionList.listVersion = version.prop("listVersion").stringValue()
    versionList.versionDate = LocalDateTime.parse(version.prop("versionDate").stringValue(), formatter)
    versionList.loadDate = LocalDateTime.parse(version.prop("loadDate").stringValue(), formatter)
    versionList.updateDate = LocalDateTime.parse(version.prop("updateDate").stringValue(), formatter)
    versionList.isLastVersion = version.prop("isLastVersion").boolValue()
    versionList.signOfTerrorist = signOfTerrorist

    saveObjects.add(versionList)
}

execution.setVariable("saveObjects", saveObjects)</bpmn:script>
            </bpmn:scriptTask>
            <bpmn:scriptTask id="Activity_1j7iunw" name="Identity List Filling" scriptFormat="groovy">
              <bpmn:incoming>Flow_1y17db5</bpmn:incoming>
              <bpmn:outgoing>Flow_064q816</bpmn:outgoing>
              <bpmn:script>import static org.camunda.spin.Spin.*
import static org.camunda.spin.DataFormats.*
import com.prime.db.rnkb.model.kyc.KycCaseClientIdentityAtrList;

import com.prime.db.rnkb.model.BaseDictionary

BaseDictionary getBd(Integer type, String code) {
    baseDictRepo.getByBaseDictionaryTypeCodeAndCode(type, code);
}

def resultItem = execution.getVariable("resultItem")
def list2Item = execution.getVariable("list2Item")
def saveObjects = execution.getVariable("saveObjects")

def ids = resultItem?.prop("record")?.prop("identityAtrList")?.elements()

ids?.each{id -&gt;
    def idType = id.prop("idType").stringValue()

    def identityList = new KycCaseClientIdentityAtrList()

    identityList.kycCaseClientList2Id = list2Item
    identityList.idType = getBd(283, idType)

    if (id.hasProp("idValue")) {
        identityList.idValue = id.prop("idValue").stringValue()
    }

    if (id.hasProp("idSerial")) {
        identityList.idSerial = id.prop("idSerial").stringValue()
    }

    if (id.hasProp("idNumber")) {
        identityList.idNumber = id.prop("idNumber").stringValue()
    }

    if (id.hasProp("Comment")) {
        identityList.comment = id.prop("Comment").stringValue()
    }

    if (id.hasProp("DateDocument")) {
        identityList.dateDocument = id.prop("DateDocument").stringValue()
    }

    if (id.hasProp("IssuingAuthority")) {
        identityList.issuingAuthority = id.prop("IssuingAuthority").stringValue()
    }

    if (id.hasProp("DateOfDocument")) {
        identityList.dateOfDocument = id.prop("DateOfDocument").stringValue()
    }

    if (id.hasProp("ExpiryDateOfDocument")) {
        identityList.expiryDateOfDocument = id.prop("ExpiryDateOfDocument").stringValue()
    }

    if (id.hasProp("ValidDoc")) {
        identityList.validDoc = id.prop("ValidDoc").stringValue()
    }

    saveObjects.add(identityList)
}

execution.setVariable("saveObjects", saveObjects)
</bpmn:script>
            </bpmn:scriptTask>
            <bpmn:scriptTask id="Activity_1i3xrqv" name="Date List Filling" scriptFormat="groovy">
              <bpmn:incoming>Flow_17xowf4</bpmn:incoming>
              <bpmn:outgoing>Flow_1y17db5</bpmn:outgoing>
              <bpmn:script>import static org.camunda.spin.Spin.*
import static org.camunda.spin.DataFormats.*
import com.prime.db.rnkb.model.kyc.KycCaseClientDateDetails;

import com.prime.db.rnkb.model.BaseDictionary

BaseDictionary getBd(Integer type, String code) {
    baseDictRepo.getByBaseDictionaryTypeCodeAndCode(type, code);
}

def resultItem = execution.getVariable("resultItem")
def list2Item = execution.getVariable("list2Item")
def saveObjects = execution.getVariable("saveObjects")

def dates = resultItem?.prop("record")?.prop("dateDetails")?.elements()

dates?.each{date -&gt;
    def dateDetails = new KycCaseClientDateDetails()

    dateDetails.kycCaseClientList2Id = list2Item
    dateDetails.dateTypeId = getBd(282, date.prop("dateTypeId").stringValue())
    if (!date.prop("dateValue").isNull())
        dateDetails.dateValue = date.prop("dateValue")?.stringValue();

    if (!date.prop("day").isNull())
        dateDetails.day = date.prop("day")?.numberValue()?.toString();

    if (!date.prop("month").isNull())
    dateDetails.month = date.prop("month")?.numberValue()?.toString();

    if (!date.prop("year").isNull())
    dateDetails.year = date.prop("year")?.numberValue()?.toString();

    saveObjects.add(dateDetails)
}

execution.setVariable("saveObjects", saveObjects)</bpmn:script>
            </bpmn:scriptTask>
            <bpmn:scriptTask id="Activity_1nbbps9" name="Address List Filling" scriptFormat="groovy">
              <bpmn:incoming>Flow_0eetssk</bpmn:incoming>
              <bpmn:outgoing>Flow_17xowf4</bpmn:outgoing>
              <bpmn:script>import static org.camunda.spin.Spin.*
import static org.camunda.spin.DataFormats.*
import com.prime.db.rnkb.model.kyc.KycCaseClientAddressList;

import com.prime.db.rnkb.model.BaseDictionary

BaseDictionary getBd(Integer type, String code) {
    baseDictRepo.getByBaseDictionaryTypeCodeAndCode(type, code);
}

def resultItem = execution.getVariable("resultItem")
def list2Item = execution.getVariable("list2Item")
def saveObjects = execution.getVariable("saveObjects")

def addresses = resultItem?.prop("record")?.prop("addressList")?.elements()

addresses?.each{address -&gt;
    def addressType = address.prop("addressType").stringValue()

    def addressList = new KycCaseClientAddressList()

    addressList.kycCaseClientList2Id = list2Item
    addressList.addressType = getBd(281, addressType)
    addressList.addressLine = address.prop("addressLine").stringValue();
    addressList.countryCOde = address.prop("CountryCode").stringValue()
    addressList.country = address.prop("Country").stringValue()

    saveObjects.add(addressList)
}

execution.setVariable("saveObjects", saveObjects)</bpmn:script>
            </bpmn:scriptTask>
            <bpmn:scriptTask id="Activity_05v8l85" name="Country List Filling" scriptFormat="groovy">
              <bpmn:incoming>Flow_064q816</bpmn:incoming>
              <bpmn:outgoing>Flow_1trwpwi</bpmn:outgoing>
              <bpmn:script>import static org.camunda.spin.Spin.*
import static org.camunda.spin.DataFormats.*
import com.prime.db.rnkb.model.kyc.KycCaseClientCountryList;

import com.prime.db.rnkb.model.BaseDictionary

BaseDictionary getBd(Integer type, String code) {
    baseDictRepo.getByBaseDictionaryTypeCodeAndCode(type, code);
}

def resultItem = execution.getVariable("resultItem")
def list2Item = execution.getVariable("list2Item")
def saveObjects = execution.getVariable("saveObjects")

def countries = resultItem?.prop("record")?.prop("countryList")?.elements()

countries?.each{country -&gt;
    def countryList = new KycCaseClientCountryList()

    countryList.kycCaseClientList2Id = list2Item
    countryList.countryType = getBd(284, country.prop("CountryType").stringValue())
    countryList.countryCode = country.prop("CountryCode").stringValue()
    countryList.countryName = country.prop("CountryName").stringValue()

    saveObjects.add(countryList)
}

execution.setVariable("saveObjects", saveObjects)</bpmn:script>
            </bpmn:scriptTask>
            <bpmn:endEvent id="Event_0eblwtk">
              <bpmn:incoming>Flow_0or65n9</bpmn:incoming>
            </bpmn:endEvent>
            <bpmn:sequenceFlow id="Flow_0or65n9" sourceRef="Activity_Save_Lists" targetRef="Event_0eblwtk" />
            <bpmn:sequenceFlow id="Flow_1dvreq0" sourceRef="Activity_09mhvto" targetRef="Activity_Save_Lists" />
            <bpmn:sequenceFlow id="Flow_1trwpwi" sourceRef="Activity_05v8l85" targetRef="Activity_09mhvto" />
            <bpmn:sequenceFlow id="Flow_064q816" sourceRef="Activity_1j7iunw" targetRef="Activity_05v8l85" />
            <bpmn:sequenceFlow id="Flow_0crol6n" sourceRef="Activity_List2_Saving" targetRef="Activity_06v13eb" />
            <bpmn:sequenceFlow id="Flow_1wdsir7" sourceRef="Activity_1c5haxn" targetRef="Activity_List2_Saving" />
            <bpmn:sequenceFlow id="Flow_0wwts1a" sourceRef="Activity_List1_Saving" targetRef="Activity_1c5haxn" />
            <bpmn:sequenceFlow id="Flow_17xowf4" sourceRef="Activity_1nbbps9" targetRef="Activity_1i3xrqv" />
            <bpmn:sequenceFlow id="Flow_1y17db5" sourceRef="Activity_1i3xrqv" targetRef="Activity_1j7iunw" />
            <bpmn:sequenceFlow id="Flow_0tnbmu6" sourceRef="Activity_09mhvto" targetRef="Activity_Save_Lists" />
            <bpmn:sequenceFlow id="Flow_0eetssk" sourceRef="Activity_06v13eb" targetRef="Activity_1nbbps9" />
            <bpmn:sequenceFlow id="Flow_19djyrd" sourceRef="Activity_00si6fi" targetRef="Activity_List1_Saving" />
            <bpmn:sequenceFlow id="Flow_0leqngs" sourceRef="Event_1pfart9" targetRef="Activity_00si6fi" />
          </bpmn:subProcess>
          <bpmn:sequenceFlow id="Flow_08yq38b" sourceRef="Activity_02vg82q" targetRef="Activity_1v5jznt" />
          <bpmn:endEvent id="Event_0m31yx9">
            <bpmn:incoming>Flow_15ogu7q</bpmn:incoming>
          </bpmn:endEvent>
          <bpmn:sequenceFlow id="Flow_15ogu7q" sourceRef="Activity_1v5jznt" targetRef="Event_0m31yx9" />
          <bpmn:sequenceFlow id="Flow_0rdzslu" sourceRef="Event_118qtrk" targetRef="Activity_0uzj693" />
          <bpmn:sequenceFlow id="Flow_1897it8" sourceRef="Activity_0uzj693" targetRef="Activity_15sew4o" />
        </bpmn:subProcess>
        <bpmn:scriptTask id="Activity_0fsct6w" name="Items Filling" scriptFormat="groovy">
          <bpmn:incoming>Flow_1nri9em</bpmn:incoming>
          <bpmn:outgoing>Flow_00656g0</bpmn:outgoing>
          <bpmn:script>import static org.camunda.spin.Spin.*
import static org.camunda.spin.DataFormats.*

def clientItem = execution.getVariable("clientItem")

def resultItems = clientItem.prop("Results")

execution.setVariable("resultItems", resultItems)</bpmn:script>
        </bpmn:scriptTask>
        <bpmn:sequenceFlow id="Flow_00656g0" sourceRef="Activity_0fsct6w" targetRef="Activity_10o7dqk" />
        <bpmn:serviceTask id="Activity_0ja45ts" name="Client Selection" camunda:delegateExpression="${selectOneDelegate}">
          <bpmn:extensionElements>
            <camunda:inputOutput>
              <camunda:inputParameter name="outputVarName">client</camunda:inputParameter>
              <camunda:inputParameter name="parameters">
                <camunda:map>
                  <camunda:entry key="clientId">${clientId}</camunda:entry>
                </camunda:map>
              </camunda:inputParameter>
              <camunda:inputParameter name="selectQuery">SELECT c FROM Client c WHERE c.exClientId = :clientId</camunda:inputParameter>
            </camunda:inputOutput>
          </bpmn:extensionElements>
          <bpmn:incoming>Flow_0k0u987</bpmn:incoming>
          <bpmn:outgoing>Flow_1nri9em</bpmn:outgoing>
        </bpmn:serviceTask>
        <bpmn:sequenceFlow id="Flow_0k0u987" sourceRef="Activity_0pnz9cm" targetRef="Activity_0ja45ts" />
        <bpmn:sequenceFlow id="Flow_1nri9em" sourceRef="Activity_0ja45ts" targetRef="Activity_0fsct6w" />
        <bpmn:endEvent id="Event_00471b9">
          <bpmn:incoming>Flow_0dk0obq</bpmn:incoming>
        </bpmn:endEvent>
        <bpmn:sequenceFlow id="Flow_0dk0obq" sourceRef="Activity_10o7dqk" targetRef="Event_00471b9" />
      </bpmn:subProcess>
      <bpmn:sequenceFlow id="Flow_0hb06iv" sourceRef="Activity_0ldya20" targetRef="Activity_Clients_Handling" />
      <bpmn:endEvent id="Event_11a48t6">
        <bpmn:incoming>Flow_0m9d8o5</bpmn:incoming>
      </bpmn:endEvent>
      <bpmn:sequenceFlow id="Flow_0m9d8o5" sourceRef="Activity_Clients_Handling" targetRef="Event_11a48t6" />
    </bpmn:subProcess>
    <bpmn:serviceTask id="Activity_1h1hznx" name="Close Session" camunda:delegateExpression="${closeSessionDelegate}">
      <bpmn:incoming>Flow_0euspvr</bpmn:incoming>
    </bpmn:serviceTask>
    <bpmn:serviceTask id="Activity_0utp56l" name="End Transaction Delegate" camunda:delegateExpression="${endTransactionDelegate}">
      <bpmn:incoming>Flow_03gukxj</bpmn:incoming>
      <bpmn:outgoing>Flow_0euspvr</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:sequenceFlow id="Flow_0euspvr" sourceRef="Activity_0utp56l" targetRef="Activity_1h1hznx" />
    <bpmn:sequenceFlow id="Flow_03gukxj" sourceRef="Activity_1mw9f6o" targetRef="Activity_0utp56l" />
    <bpmn:sequenceFlow id="Flow_0v9yh38" sourceRef="Activity_0uuh0i5" targetRef="Activity_1mw9f6o" />
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="amlCsmKycClientRequest">
      <bpmndi:BPMNEdge id="BPMNEdge_1jh5w26" bpmnElement="Flow_1crfnfk">
        <di:waypoint x="195" y="440" />
        <di:waypoint x="230" y="440" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_0auvdjj" bpmnElement="Flow_05quuqa">
        <di:waypoint x="330" y="440" />
        <di:waypoint x="380" y="440" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_0banurn" bpmnElement="Flow_15jyl5l">
        <di:waypoint x="480" y="440" />
        <di:waypoint x="530" y="440" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_03gukxj_di" bpmnElement="Flow_03gukxj">
        <di:waypoint x="5370" y="390" />
        <di:waypoint x="5480" y="390" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_15rcu80" bpmnElement="Flow_0euspvr">
        <di:waypoint x="5580" y="390" />
        <di:waypoint x="5650" y="390" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0v9yh38_di" bpmnElement="Flow_0v9yh38">
        <di:waypoint x="630" y="440" />
        <di:waypoint x="700" y="440" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="BPMNShape_1tuq9xm" bpmnElement="Event_0bpxwwc">
        <dc:Bounds x="159" y="422" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_0sz0otu" bpmnElement="Activity_0fehiu4">
        <dc:Bounds x="230" y="400" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1yjpznm" bpmnElement="Activity_0p5b1rm">
        <dc:Bounds x="380" y="400" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_0fqc74d" bpmnElement="Activity_0uuh0i5">
        <dc:Bounds x="530" y="400" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_0yqakym" bpmnElement="Activity_1h1hznx">
        <dc:Bounds x="5650" y="350" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_0dhs369" bpmnElement="Activity_0utp56l">
        <dc:Bounds x="5480" y="350" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1mw9f6o_di" bpmnElement="Activity_1mw9f6o" isExpanded="true">
        <dc:Bounds x="700" y="80" width="4670" height="620" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_0nm40x4_di" bpmnElement="Flow_0nm40x4">
        <di:waypoint x="776" y="440" />
        <di:waypoint x="810" y="440" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0hb06iv_di" bpmnElement="Flow_0hb06iv">
        <di:waypoint x="910" y="440" />
        <di:waypoint x="950" y="440" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0m9d8o5_di" bpmnElement="Flow_0m9d8o5">
        <di:waypoint x="5230" y="400" />
        <di:waypoint x="5282" y="400" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="Event_01z62wt_di" bpmnElement="Event_01z62wt">
        <dc:Bounds x="740" y="422" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_15nnyml" bpmnElement="Activity_0ldya20">
        <dc:Bounds x="810" y="400" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_11a48t6_di" bpmnElement="Event_11a48t6">
        <dc:Bounds x="5282" y="382" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0h6rz8w_di" bpmnElement="Activity_Clients_Handling" isExpanded="true">
        <dc:Bounds x="950" y="130" width="4280" height="540" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_0u6jn9h_di" bpmnElement="Flow_0u6jn9h">
        <di:waypoint x="1008" y="440" />
        <di:waypoint x="1050" y="440" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_00656g0_di" bpmnElement="Flow_00656g0">
        <di:waypoint x="1500" y="440" />
        <di:waypoint x="1620" y="440" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0k0u987_di" bpmnElement="Flow_0k0u987">
        <di:waypoint x="1150" y="440" />
        <di:waypoint x="1230" y="440" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1nri9em_di" bpmnElement="Flow_1nri9em">
        <di:waypoint x="1330" y="440" />
        <di:waypoint x="1400" y="440" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0dk0obq_di" bpmnElement="Flow_0dk0obq">
        <di:waypoint x="5020" y="395" />
        <di:waypoint x="5072" y="395" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="Event_1xfcm0n_di" bpmnElement="Event_1xfcm0n">
        <dc:Bounds x="972" y="422" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1daer2i" bpmnElement="Activity_0pnz9cm">
        <dc:Bounds x="1050" y="400" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_00471b9_di" bpmnElement="Event_00471b9">
        <dc:Bounds x="5072" y="377" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_0xqx516" bpmnElement="Activity_0ja45ts">
        <dc:Bounds x="1230" y="400" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_0e192h5" bpmnElement="Activity_0fsct6w">
        <dc:Bounds x="1400" y="400" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_10o7dqk_di" bpmnElement="Activity_10o7dqk" isExpanded="true">
        <dc:Bounds x="1620" y="180" width="3400" height="430" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="BPMNEdge_0f7a756" bpmnElement="Flow_0sn2zax">
        <di:waypoint x="2200" y="415" />
        <di:waypoint x="2200" y="300" />
        <di:waypoint x="2270" y="300" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2216" y="282" width="39" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_126k050" bpmnElement="Flow_00mgcwc">
        <di:waypoint x="2225" y="440" />
        <di:waypoint x="2362" y="440" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2276" y="422" width="39" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_1tqn68u" bpmnElement="Flow_05f27h4">
        <di:waypoint x="2370" y="300" />
        <di:waypoint x="2400" y="300" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1vua5pp_di" bpmnElement="Flow_1vua5pp">
        <di:waypoint x="2060" y="440" />
        <di:waypoint x="2175" y="440" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1yqdt8n_di" bpmnElement="Flow_1yqdt8n">
        <di:waypoint x="2500" y="300" />
        <di:waypoint x="2520" y="300" />
        <di:waypoint x="2520" y="440" />
        <di:waypoint x="2570" y="440" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1vgkfgw_di" bpmnElement="Flow_1vgkfgw">
        <di:waypoint x="2200" y="465" />
        <di:waypoint x="2200" y="500" />
        <di:waypoint x="2570" y="500" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2284" y="475" width="39" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_08yq38b_di" bpmnElement="Flow_08yq38b">
        <di:waypoint x="3060" y="440" />
        <di:waypoint x="3110" y="440" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_15ogu7q_di" bpmnElement="Flow_15ogu7q">
        <di:waypoint x="4870" y="440" />
        <di:waypoint x="4922" y="440" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0rdzslu_di" bpmnElement="Flow_0rdzslu">
        <di:waypoint x="1696" y="440" />
        <di:waypoint x="1770" y="440" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1897it8_di" bpmnElement="Flow_1897it8">
        <di:waypoint x="1870" y="440" />
        <di:waypoint x="1960" y="440" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="Event_118qtrk_di" bpmnElement="Event_118qtrk">
        <dc:Bounds x="1660" y="422" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1lhf6pn" bpmnElement="Gateway_0uxnypy" isMarkerVisible="true">
        <dc:Bounds x="2175" y="415" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_03icpep" bpmnElement="Activity_15cx39w">
        <dc:Bounds x="2270" y="260" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_16h2c9d" bpmnElement="Activity_1js50xw">
        <dc:Bounds x="2400" y="260" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_0rmuzvk" bpmnElement="Event_09g1ver">
        <dc:Bounds x="2362" y="422" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_0m31yx9_di" bpmnElement="Event_0m31yx9">
        <dc:Bounds x="4922" y="422" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_0uvjv0r" bpmnElement="Activity_0uzj693">
        <dc:Bounds x="1770" y="400" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_0yjt5uz" bpmnElement="Activity_15sew4o">
        <dc:Bounds x="1960" y="400" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1pzr1q0" bpmnElement="Activity_1v5jznt" isExpanded="true">
        <dc:Bounds x="3110" y="346" width="1760" height="188" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="BPMNEdge_0yyoeum" bpmnElement="Flow_0or65n9">
        <di:waypoint x="4730" y="436" />
        <di:waypoint x="4792" y="436" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_00vq379" bpmnElement="Flow_1dvreq0">
        <di:waypoint x="4570" y="436" />
        <di:waypoint x="4630" y="436" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_1oa90xb" bpmnElement="Flow_1trwpwi">
        <di:waypoint x="4420" y="436" />
        <di:waypoint x="4470" y="436" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_0sv6qyg" bpmnElement="Flow_064q816">
        <di:waypoint x="4270" y="436" />
        <di:waypoint x="4320" y="436" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_0mlpzkm" bpmnElement="Flow_0crol6n">
        <di:waypoint x="3730" y="436" />
        <di:waypoint x="3760" y="436" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_12axuwj" bpmnElement="Flow_1wdsir7">
        <di:waypoint x="3590" y="436" />
        <di:waypoint x="3630" y="436" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_1a6cgc8" bpmnElement="Flow_0wwts1a">
        <di:waypoint x="3460" y="436" />
        <di:waypoint x="3490" y="436" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_1co6cji" bpmnElement="Flow_17xowf4">
        <di:waypoint x="3980" y="436" />
        <di:waypoint x="4020" y="436" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_0mxnxk2" bpmnElement="Flow_1y17db5">
        <di:waypoint x="4120" y="436" />
        <di:waypoint x="4170" y="436" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_1d57pdp" bpmnElement="Flow_0tnbmu6">
        <di:waypoint x="4570" y="436" />
        <di:waypoint x="4630" y="436" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_15fmi21" bpmnElement="Flow_0eetssk">
        <di:waypoint x="3860" y="436" />
        <di:waypoint x="3880" y="436" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_1cbsmjj" bpmnElement="Flow_19djyrd">
        <di:waypoint x="3320" y="436" />
        <di:waypoint x="3360" y="436" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_1qyoci5" bpmnElement="Flow_0leqngs">
        <di:waypoint x="3178" y="436" />
        <di:waypoint x="3220" y="436" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="BPMNShape_1skvggg" bpmnElement="Event_1pfart9">
        <dc:Bounds x="3142" y="418" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1ed4itf" bpmnElement="Activity_00si6fi">
        <dc:Bounds x="3220" y="396" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1a72wnn" bpmnElement="Activity_06v13eb">
        <dc:Bounds x="3760" y="396" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_16n6ysa" bpmnElement="Activity_List1_Saving">
        <dc:Bounds x="3360" y="396" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_07qc3m6" bpmnElement="Activity_1c5haxn">
        <dc:Bounds x="3490" y="396" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1gtz0ii" bpmnElement="Activity_List2_Saving">
        <dc:Bounds x="3630" y="396" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1ueuq6b" bpmnElement="Activity_Save_Lists">
        <dc:Bounds x="4630" y="396" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1xlbcgf" bpmnElement="Activity_09mhvto">
        <dc:Bounds x="4470" y="396" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_0gt0z2j" bpmnElement="Activity_1j7iunw">
        <dc:Bounds x="4170" y="396" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_0nsvm6h" bpmnElement="Activity_1i3xrqv">
        <dc:Bounds x="4020" y="396" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_0lod7r1" bpmnElement="Activity_1nbbps9">
        <dc:Bounds x="3880" y="396" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1ccuw3x" bpmnElement="Activity_05v8l85">
        <dc:Bounds x="4320" y="396" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1hd56ex" bpmnElement="Event_0eblwtk">
        <dc:Bounds x="4792" y="418" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_04uo9hr" bpmnElement="Activity_02vg82q" isExpanded="true">
        <dc:Bounds x="2570" y="340" width="490" height="200" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="BPMNEdge_0q9oh8h" bpmnElement="Flow_0vgu2xc">
        <di:waypoint x="2950" y="440" />
        <di:waypoint x="3002" y="440" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_0roknli" bpmnElement="Flow_0xqw8f0">
        <di:waypoint x="2780" y="440" />
        <di:waypoint x="2850" y="440" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_0uikk8q" bpmnElement="Flow_18xp7a5">
        <di:waypoint x="2626" y="440" />
        <di:waypoint x="2680" y="440" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="BPMNShape_0jbgcos" bpmnElement="Event_09o8qzt">
        <dc:Bounds x="2590" y="422" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1lm74z8" bpmnElement="Activity_1cp5fv0">
        <dc:Bounds x="2680" y="400" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_197knfl" bpmnElement="Activity_Case_Saving">
        <dc:Bounds x="2850" y="400" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_05gcfyi" bpmnElement="Event_0m0mboy">
        <dc:Bounds x="3002" y="422" width="36" height="36" />
      </bpmndi:BPMNShape>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
